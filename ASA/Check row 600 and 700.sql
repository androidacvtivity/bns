SELECT 
CC.CODUL,
CC.DENUMIRE,
CC.FULL_CODE,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('150') THEN  D.COL1 ELSE NULL END ),1) AS RIND_150_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('160') THEN  D.COL1 ELSE  NULL END ),1) AS RIND_160_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('170') THEN  D.COL1 ELSE  NULL END ),1) AS RIND_170_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('200') THEN  D.COL1 ELSE  NULL END ),1) AS RIND_200_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN  D.COL1 ELSE  NULL END ),1) AS RIND_330_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN  D.COL2 ELSE  NULL END ),1) AS RIND_330_COL2,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN  D.COL1 ELSE  NULL END ),1) AS RIND_340_COL1,
ROUND(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN  D.COL2 ELSE  NULL END ),1) AS RIND_340_COL2,
 
ROUND (CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('150','160','170') THEN  CIS2.NVAL(D.COL1) END))- 
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('200') THEN CIS2.NVAL(D.COL1) END))+
(CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN CIS2.NVAL(D.COL2) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN CIS2.NVAL(D.COL1) END)))+
 
(CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN CIS2.NVAL(D.COL2) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN CIS2.NVAL(D.COL1) END))),1)  AS COL1,
  
ROuND( CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('150','160','170') THEN  CIS2.NVAL(D.COL1) END))- 
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('200') THEN CIS2.NVAL(D.COL1) END))+
(CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN CIS2.NVAL(D.COL2) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('330') THEN CIS2.NVAL(D.COL1) END)))+
 
(CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN CIS2.NVAL(D.COL2) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1126) AND D.RIND IN ('340') THEN CIS2.NVAL(D.COL1) END)))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('220') THEN CIS2.NVAL(D.COL1) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('240') THEN CIS2.NVAL(D.COL1) END))-
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('290') THEN CIS2.NVAL(D.COL1) END))+
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1125) AND D.RIND IN ('294') THEN CIS2.NVAL(D.COL1) END))+
 CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN (1124) AND D.RIND IN ('180') THEN CIS2.NVAL(D.COL1) END)),1)   AS COL2

                                                      

FROM   
    CIS2.VW_DATA_ALL_COEF D  
    
            INNER JOIN CIS2.VW_CL_CFP C ON (C.CODUL = D.CFP)
            INNER JOIN CIS2.VW_CL_CFP CC ON (C.FULL_CODE LIKE '%'||CC.CODUL||';%')
            
    
WHERE
  D.FORM IN (64)             AND 
  D.FORM_VERS = 2000  AND      
  D.PERIOADA = 2009 AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%'   AND
  D.CAPITOL IN (1123,1124,1125,1126,1127,128,1129)
 

GROUP BY
CC.CODUL,
CC.DENUMIRE,
CC.FULL_CODE

ORDER BY

CC.FULL_CODE