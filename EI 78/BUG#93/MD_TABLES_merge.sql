SET DEFINE OFF;
MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9508 as ID_MDTABLE,
  '1' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.1' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  1.4 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'   ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'    CASE WHEN SUBSTR(NR_ROW,1,1) = ''~'' THEN ''0''||NR_ROW ELSE NR_ROW END NR_ROW,   '||CHR(13)||CHR(10)||'   ROWNUM AS ORDINE,'||CHR(13)||CHR(10)||'  ''1111'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'   NUME_ROW,'||CHR(13)||CHR(10)||'   ROUND(COL1,1) COL1,'||CHR(13)||CHR(10)||'   ROUND(COL2,1) COL2,'||CHR(13)||CHR(10)||'  ROUND(COL3,1) COL3,'||CHR(13)||CHR(10)||'  ROUND(COL4,1) COL4'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'   --CASE WHEN REPLACE (CODUL_SERV,''0'')||''~''||ROWNUM/0.123 IS NULL THEN ''0'' ELSE REPLACE (CODUL_SERV,''0'')||''~''||ROWNUM END  AS NR_ROW,'||CHR(13)||CHR(10)||'   CASE WHEN rtrim (CODUL_SERV,''0'')||''~''||ROWNUM/0.123 IS NULL THEN ''0'' ELSE rtrim (CODUL_SERV,''0'')||''~''||ROWNUM/0.123 END  AS NR_ROW,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ORDINE, '||CHR(13)||CHR(10)||'   DENUMIRE  NUME_ROW,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL3,'||CHR(13)||CHR(10)||'  COL4'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    1 ORDINE,'||CHR(13)||CHR(10)||'     SSS.DENUMIRE,'||CHR(13)||CHR(10)||'     SSS.CODUL    CODUL_SERV,'||CHR(13)||CHR(10)||'     SSS.FULL_CODE,'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)   +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL1,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)) / CR.COL1 )/1000,1) AS COL2,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL3,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END )  ) / CR.COL1)/1000,1) AS COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN MD_CAPITOL MC ON MR.CAPITOL = MC.CAPITOL AND MR.CAPITOL_VERS = MC.CAPITOL_VERS'||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_SERVICII SS ON ((RTRIM(SS.CODUL,''0'') )=D.COL1)     '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )  '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410,411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'      GROUP BY'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'       SSS.DENUMIRE,'||CHR(13)||CHR(10)||'       SSS.CODUL,'||CHR(13)||CHR(10)||'       SSS.FULL_CODE,'||CHR(13)||CHR(10)||'       CR.COL1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||' UNION'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' SELECT'||CHR(13)||CHR(10)||'  ORDINE_TARA,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  CODUL_SERV,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL3,'||CHR(13)||CHR(10)||'  COL4'||CHR(13)||CHR(10)||'FROM('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     2 ORDINE,'||CHR(13)||CHR(10)||'     TTT.ORDINE AS ORDINE_TARA,'||CHR(13)||CHR(10)||'     TTT.DENUMIRE,'||CHR(13)||CHR(10)||'     SSS.CODUL CODUL_SERV,'||CHR(13)||CHR(10)||'     SSS.FULL_CODE,'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)   +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL1,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)) / CR.COL1 )/1000,1) AS COL2,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL3,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END )  ) / CR.COL1)/1000,1) AS COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.RENIM  R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.VW_CL_TARI TTT ON (TT.FULL_CODE LIKE ''%'' ||TTT.CODUL||'';%'' )   '||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'       INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       INNER  JOIN MD_CAPITOL MC ON MR.CAPITOL = MC.CAPITOL AND MR.CAPITOL_VERS = MC.CAPITOL_VERS'||CHR(13)||CHR(10)||'       INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410,411,403)'||CHR(13)||CHR(10)||'  AND TTT.CODUL NOT IN (''000'')'||CHR(13)||CHR(10)||'  AND SSS.CODUL NOT IN (''0000000'')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'      GROUP BY'||CHR(13)||CHR(10)||'      SSS.CODUL,'||CHR(13)||CHR(10)||'      TTT.CODUL,'||CHR(13)||CHR(10)||'      TTT.FULL_CODE,'||CHR(13)||CHR(10)||'      SSS.FULL_CODE,'||CHR(13)||CHR(10)||'      TTT.ORDINE,'||CHR(13)||CHR(10)||'      TTT.DENUMIRE,'||CHR(13)||CHR(10)||'      CR.COL1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'    ORDER BY'||CHR(13)||CHR(10)||'    TTT.ORDINE '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||' ORDER BY'||CHR(13)||CHR(10)||'  CODUL_SERV,'||CHR(13)||CHR(10)||'  ORDINE'||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    INSERT INTO  USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9506 as ID_MDTABLE,
  '2' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab. 3 ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  3 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' SELECT   '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     AA.ORDINE  AS ORDINE,'||CHR(13)||CHR(10)||'    ''1111'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     AA.NUME_ROW AS NUME_ROW,'||CHR(13)||CHR(10)||'     ROUND(AA.COL1 / 1000,1)   AS COL1,'||CHR(13)||CHR(10)||'     ROUND(AA.COL2 / 1000,1)   AS COL2,'||CHR(13)||CHR(10)||'     ROUND(AA.COL3 / 1000,1)   AS COL3,'||CHR(13)||CHR(10)||'     ROUND(AA.COL4 / 1000,1)   AS COL4'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     FROM'||CHR(13)||CHR(10)||'     ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     CD.NR_ROW   AS NR_ROW,'||CHR(13)||CHR(10)||'     CD.NR_ROW   AS ORDINE,'||CHR(13)||CHR(10)||'     CD.NUME_ROW AS NUME_ROW,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  CT.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND  MR.CAPITOL IN (409)  AND MR.RIND IN (''1'')  THEN NVAL(D.COL4) ELSE 0 END )  AS COL1,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  CT.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND  MR.CAPITOL IN (409)  AND MR.RIND IN (''1'')  THEN NVAL(D.COL4) ELSE 0 END ) / CR.COL1  AS COL2,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  CT.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND  MR.CAPITOL IN (411)  AND MR.RIND IN (''1'')  THEN NVAL(D.COL4) ELSE 0 END )  AS COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  CT.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND  MR.CAPITOL IN (411)  AND MR.RIND IN (''1'')  THEN NVAL(D.COL4) ELSE 0 END ) / CR.COL1  AS COL4'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM DATA_ALL D'||CHR(13)||CHR(10)||'          INNER JOIN RENIM RN ON D.CUIIO = RN.CUIIO AND D.CUIIO_VERS = RN.CUIIO_VERS'||CHR(13)||CHR(10)||'          INNER  JOIN VW_CL_CUATM CT ON RN.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'          CROSS JOIN  ('||CHR(13)||CHR(10)||'           SELECT DENUMIRE AS NUME_ROW, RIND AS NR_ROW,RINDOUT AS CUATM FROM USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'             WHERE '||CHR(13)||CHR(10)||'            ID_MDTABLE = 8096) CD  '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR '||CHR(13)||CHR(10)||'             '||CHR(13)||CHR(10)||' WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,406,411,408)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'    CD.NR_ROW,'||CHR(13)||CHR(10)||'    CD.NUME_ROW,'||CHR(13)||CHR(10)||'    CR.COL1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'    ORDER BY '||CHR(13)||CHR(10)||'    CD.NR_ROW'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) AA '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ORDER BY AA.ORDINE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ) DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO --  USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10507 as ID_MDTABLE,
  '3' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.4 b' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  4.7 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    REGEXP_REPLACE(DF.NUME_ROW,''(^[[:space:]]*|[[:space:]]*$)'') AS NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     NR_SECTIE   AS NR_SECTIE,'||CHR(13)||CHR(10)||'     NUME_SECTIE AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2, '||CHR(13)||CHR(10)||' A.CUIIO||''~''||ROWNUM NR_ROW,'||CHR(13)||CHR(10)||' ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||' ''000004'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'  TRIM(A.DENUMIRE) NUME_ROW,'||CHR(13)||CHR(10)||'    A.COL7   COL1,'||CHR(13)||CHR(10)||'    A.COL1   COL2,'||CHR(13)||CHR(10)||'    A.COL2   COL3,'||CHR(13)||CHR(10)||'    A.COL3   COL4,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    ---------------------'||CHR(13)||CHR(10)||'    ROUND(A.COL4,0)   COL5,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'                              )  AS  COL6 '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    --------------------'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'    CODUL ||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    SUM(COL3)  COL3,'||CHR(13)||CHR(10)||'    SUM(COL4)  COL4,'||CHR(13)||CHR(10)||'    SUM(COL5)  COL5,'||CHR(13)||CHR(10)||'    MAX(COL6)  COL6,'||CHR(13)||CHR(10)||'    MAX(COL7)  COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    NULL   AS  COL2,'||CHR(13)||CHR(10)||'    NULL   AS  COL3,'||CHR(13)||CHR(10)||'    NULL   AS  COL4,'||CHR(13)||CHR(10)||'    NULL   AS  COL5,'||CHR(13)||CHR(10)||'    D.CUIIO   AS  COL6,'||CHR(13)||CHR(10)||'    MAX(CASE WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''01'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  1  '||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''02'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  2'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''03'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  3'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''04'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  4'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''05'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  5'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''06'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  6'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''07'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  7  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    END) COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (1)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''0'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''2'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''3'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'4||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'   D.COL1,'||CHR(13)||CHR(10)||'  D.COL3 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'    UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''6'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ----------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  -------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'7||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL             COL1,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'UNION '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    NULL DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    NULL RIND,'||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''9'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL3,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL4,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL,'||CHR(13)||CHR(10)||'    FULL_CODE,'||CHR(13)||CHR(10)||'    DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY '||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'   A'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   NR_SECTIE  IN ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4,  COL5, COL6'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  6 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9510 as ID_MDTABLE,
  '3.1' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.4 b - Pachete' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  4.71 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    REGEXP_REPLACE(DF.NUME_ROW,''(^[[:space:]]*|[[:space:]]*$)'') AS NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     NR_SECTIE   AS NR_SECTIE,'||CHR(13)||CHR(10)||'     NUME_SECTIE AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2, '||CHR(13)||CHR(10)||' A.CUIIO||''~''||ROWNUM NR_ROW,'||CHR(13)||CHR(10)||' ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||' ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'  TRIM(A.DENUMIRE) NUME_ROW,'||CHR(13)||CHR(10)||'   A.COL8   COL1,'||CHR(13)||CHR(10)||'    A.COL7   COL2,'||CHR(13)||CHR(10)||'    A.COL1   COL3,'||CHR(13)||CHR(10)||'    A.COL2   COL4,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    ---------------------'||CHR(13)||CHR(10)||'    ROUND(A.COL3,0)   COL5,'||CHR(13)||CHR(10)||'    ROUND(A.COL4,0)   COL6,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'                              )  AS  COL7 '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    --------------------'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'    CODUL ||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    SUM(COL3)  COL3,'||CHR(13)||CHR(10)||'    SUM(COL4)  COL4,'||CHR(13)||CHR(10)||'    SUM(COL5)  COL5,'||CHR(13)||CHR(10)||'    MAX(COL6)  COL6,'||CHR(13)||CHR(10)||'    MAX(COL7)  COL7,'||CHR(13)||CHR(10)||'    MAX(COL8)  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    NULL   AS  COL2,'||CHR(13)||CHR(10)||'    NULL   AS  COL3,'||CHR(13)||CHR(10)||'    NULL   AS  COL4,'||CHR(13)||CHR(10)||'    NULL   AS  COL5,'||CHR(13)||CHR(10)||'    D.CUIIO   AS  COL6,'||CHR(13)||CHR(10)||'    MAX(CASE WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''01'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  1  '||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''02'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  2'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''03'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  3'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''04'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  4'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''05'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  5'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''06'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  6'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (1) AND MR.RIND IN (''07'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  7  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    END) COL7,'||CHR(13)||CHR(10)||'     D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (1)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''0'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''2'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''3'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'4||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7,'||CHR(13)||CHR(10)||'COL8 AS COL8'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'   D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'    UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''6'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ----------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  -------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'7||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7,'||CHR(13)||CHR(10)||'COL8'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL             COL1,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (410)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET, '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'UNION '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    NULL DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    NULL RIND,'||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''9'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL3,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL4,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    NULL AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL,'||CHR(13)||CHR(10)||'    FULL_CODE,'||CHR(13)||CHR(10)||'    DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY '||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'   A'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   NR_SECTIE  IN ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4,  COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10508 as ID_MDTABLE,
  '4' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.5 b' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  5.3 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    REGEXP_REPLACE(DF.NUME_ROW,''(^[[:space:]]*|[[:space:]]*$)'') AS NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     NR_SECTIE   AS NR_SECTIE,'||CHR(13)||CHR(10)||'     NUME_SECTIE AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2, '||CHR(13)||CHR(10)||' A.CUIIO||''~''||ROWNUM NR_ROW,'||CHR(13)||CHR(10)||' ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||' ''000004'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'  TRIM(A.DENUMIRE) NUME_ROW,'||CHR(13)||CHR(10)||'    A.COL7   COL1,'||CHR(13)||CHR(10)||'    A.COL1   COL2,'||CHR(13)||CHR(10)||'    A.COL2   COL3,'||CHR(13)||CHR(10)||'    A.COL3   COL4,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    ---------------------'||CHR(13)||CHR(10)||'    ROUND(A.COL4,0)   COL5,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'                              )  AS  COL6 '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    --------------------'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'    CODUL ||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    SUM(COL3)  COL3,'||CHR(13)||CHR(10)||'    SUM(COL4)  COL4,'||CHR(13)||CHR(10)||'    SUM(COL5)  COL5,'||CHR(13)||CHR(10)||'    MAX(COL6)  COL6,'||CHR(13)||CHR(10)||'    MAX(COL7)  COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    NULL   AS  COL2,'||CHR(13)||CHR(10)||'    NULL   AS  COL3,'||CHR(13)||CHR(10)||'    NULL   AS  COL4,'||CHR(13)||CHR(10)||'    NULL   AS  COL5,'||CHR(13)||CHR(10)||'    D.CUIIO   AS  COL6,'||CHR(13)||CHR(10)||'    MAX(CASE WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''01'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  1  '||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''02'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  2'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''03'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  3'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''04'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  4'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''05'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  5'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''06'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  6'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''07'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  7  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    END) COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (404)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''0'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''2'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''3'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'4||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'   D.COL1,'||CHR(13)||CHR(10)||'  D.COL3 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'    UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''6'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ----------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  -------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'7||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL             COL1,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'UNION '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    NULL DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    NULL RIND,'||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''9'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL3,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL4,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL,'||CHR(13)||CHR(10)||'    FULL_CODE,'||CHR(13)||CHR(10)||'    DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY '||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'   A'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   NR_SECTIE  IN ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4030000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4,  COL5, COL6'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  6 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9524 as ID_MDTABLE,
  '4.1' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.5 b - Pachete' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  5.4 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    REGEXP_REPLACE(DF.NUME_ROW,''(^[[:space:]]*|[[:space:]]*$)'') AS NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     NR_SECTIE   AS NR_SECTIE,'||CHR(13)||CHR(10)||'     NUME_SECTIE AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2, '||CHR(13)||CHR(10)||' A.CUIIO||''~''||ROWNUM NR_ROW,'||CHR(13)||CHR(10)||' ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||' ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'  TRIM(A.DENUMIRE) NUME_ROW,'||CHR(13)||CHR(10)||'   A.COL8   COL1,'||CHR(13)||CHR(10)||'    A.COL7   COL2,'||CHR(13)||CHR(10)||'    A.COL1   COL3,'||CHR(13)||CHR(10)||'    A.COL2   COL4,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    ---------------------'||CHR(13)||CHR(10)||'    ROUND(A.COL3,0)   COL5,'||CHR(13)||CHR(10)||'    ROUND(A.COL4,0)   COL6,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'                              )  AS  COL7 '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    --------------------'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'    CODUL ||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    SUM(COL3)  COL3,'||CHR(13)||CHR(10)||'    SUM(COL4)  COL4,'||CHR(13)||CHR(10)||'    SUM(COL5)  COL5,'||CHR(13)||CHR(10)||'    MAX(COL6)  COL6,'||CHR(13)||CHR(10)||'    MAX(COL7)  COL7,'||CHR(13)||CHR(10)||'    MAX(COL8)  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    NULL   AS  COL2,'||CHR(13)||CHR(10)||'    NULL   AS  COL3,'||CHR(13)||CHR(10)||'    NULL   AS  COL4,'||CHR(13)||CHR(10)||'    NULL   AS  COL5,'||CHR(13)||CHR(10)||'    D.CUIIO   AS  COL6,'||CHR(13)||CHR(10)||'    MAX(CASE WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''01'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  1  '||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''02'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  2'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''03'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  3'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''04'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  4'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''05'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  5'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''06'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  6'||CHR(13)||CHR(10)||'             WHEN  MR.CAPITOL IN (404) AND MR.RIND IN (''07'') AND   USER_BANCU.NVAL(D.COL1) = 1 THEN  7  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    END) COL7,'||CHR(13)||CHR(10)||'     D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (404)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''0'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''2'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''3'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'4||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7,'||CHR(13)||CHR(10)||'COL8 AS COL8'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'   D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    4||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL   AS  COL1,'||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CC.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT IN (''1'',''2'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  D.PACHET  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'    UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    MR.DENUMIRE,'||CHR(13)||CHR(10)||'    ''6'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS  COL1,'||CHR(13)||CHR(10)||'    NULL AS  COL2,'||CHR(13)||CHR(10)||'   ------------------------- '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    ------------------------------'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  MR.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1,'||CHR(13)||CHR(10)||'  D.PACHET '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ----------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  -------------------------------------------------------------------------------  '||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'CODUL,'||CHR(13)||CHR(10)||'FULL_CODE,'||CHR(13)||CHR(10)||'DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'CUIIO,'||CHR(13)||CHR(10)||'DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'RIND,'||CHR(13)||CHR(10)||'DENUMIRE,'||CHR(13)||CHR(10)||'7||''_''||TO_CHAR(ROWNUM,''000'') ORDINE,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4,'||CHR(13)||CHR(10)||'COL5,'||CHR(13)||CHR(10)||'NULL COL6,'||CHR(13)||CHR(10)||'NULL AS COL7,'||CHR(13)||CHR(10)||'COL8'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  NULL DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'  NULL RIND,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  SUM(COL3) COL3,'||CHR(13)||CHR(10)||'  SUM(COL4) COL4,'||CHR(13)||CHR(10)||'  SUM(COL5) COL5,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    SS.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1 AS ORDINE, '||CHR(13)||CHR(10)||'    D.COL1 AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     D.PACHET AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'        SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET,'||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    R.DENUMIRE DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    MR.RIND,'||CHR(13)||CHR(10)||'    TT.DENUMIRE,'||CHR(13)||CHR(10)||'    7||''_''||D.COL1||''_''||D.COL3 AS ORDINE, '||CHR(13)||CHR(10)||'    NULL             COL1,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    D.COL3 AS  COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN D.COL4 IS NOT NULL THEN D.COL4 END) / CR.COL1 COL4,'||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    D.PACHET AS COL8 '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')  '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (403)'||CHR(13)||CHR(10)||'  AND MR.RIND NOT  IN (''1'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  MR.RIND,'||CHR(13)||CHR(10)||'  TT.DENUMIRE,'||CHR(13)||CHR(10)||'  D.PACHET, '||CHR(13)||CHR(10)||'  D.COL1,'||CHR(13)||CHR(10)||'  D.COL3,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  DENUMIRE,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1,'||CHR(13)||CHR(10)||'  COL2,'||CHR(13)||CHR(10)||'  COL8'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'UNION '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    NULL DENUMIRE_CUIIO, '||CHR(13)||CHR(10)||'    NULL RIND,'||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    ''9'' AS ORDINE, '||CHR(13)||CHR(10)||'    NULL AS COL1,'||CHR(13)||CHR(10)||'    NULL AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL3,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL4,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    NULL AS COL5,'||CHR(13)||CHR(10)||'    NULL AS COL6,'||CHR(13)||CHR(10)||'    NULL AS COL7,'||CHR(13)||CHR(10)||'    NULL AS COL8'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'        INNER  JOIN VW_CL_CUATM CT ON R.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    CODUL,'||CHR(13)||CHR(10)||'    FULL_CODE,'||CHR(13)||CHR(10)||'    DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE_CUIIO,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY '||CHR(13)||CHR(10)||'  CODUL,'||CHR(13)||CHR(10)||'  FULL_CODE,'||CHR(13)||CHR(10)||'  DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'   A'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   NR_SECTIE  IN ('||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4,  COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9507 as ID_MDTABLE,
  '5' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab. 6' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  6 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     C.ORDINE NR_ROW,'||CHR(13)||CHR(10)||'     C.ORDINE   AS ORDINE,'||CHR(13)||CHR(10)||'     ''1111'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     c.denumire NUME_ROW,'||CHR(13)||CHR(10)||'     ROUND(R.COL1 / 1000,1)   AS COL1,'||CHR(13)||CHR(10)||'     ROUND(R.COL2 / 1000,1)   AS COL2,'||CHR(13)||CHR(10)||'     ROUND(R.COL3 / 1000,1)   AS COL3,'||CHR(13)||CHR(10)||'     ROUND(R.COL4 / 1000,1)   AS COL4'||CHR(13)||CHR(10)||'  FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'           SELECT   '||CHR(13)||CHR(10)||'            c.codul,'||CHR(13)||CHR(10)||'            c.denumire,'||CHR(13)||CHR(10)||'            c.grupa,'||CHR(13)||CHR(10)||'            ROWNUM ordine,'||CHR(13)||CHR(10)||'            c.full_code'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            FROM USER_BANCU.VW_CL_CAEM2 C'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            WHERE '||CHR(13)||CHR(10)||'            C.CODUL LIKE ''%0000'''||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            ORDER BY '||CHR(13)||CHR(10)||'            c.full_code'||CHR(13)||CHR(10)||'            ) C '||CHR(13)||CHR(10)||'            LEFT JOIN'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            ('||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            SELECT '||CHR(13)||CHR(10)||'    CC.CODUL,'||CHR(13)||CHR(10)||'    CC.DENUMIRE, '||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.CAPITOL IN (409)  AND D.RIND IN (''1'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )   AS COL1,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ROUND(SUM(CASE WHEN  D.CAPITOL IN (409)  AND D.RIND IN (''1'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ) / CR.COL1,0)   AS COL2,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.CAPITOL IN (411)  AND D.RIND IN (''1'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  AS COL3,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND(SUM(CASE WHEN  D.CAPITOL IN (411)  AND D.RIND IN (''1'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  / CR.COL1,0)  AS COL4'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'         INNER JOIN     USER_BANCU.VW_CL_CAEM2 C  ON  (C.CODUL=D.CAEM2)'||CHR(13)||CHR(10)||'         INNER JOIN     USER_BANCU.VW_CL_CAEM2 CC  ON (C.FULL_CODE LIKE ''%'' ||CC.CODUL||'';%'' )   '||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'      -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') )  CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------       '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND D.CAPITOL IN (409,411)  AND D.RIND IN (''1'')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||' AND CC.CODUL LIKE ''%0000'''||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY '||CHR(13)||CHR(10)||'  CC.FULL_CODE'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )     R  ON (R.CODUL = C.CODUL)'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ORDER BY '||CHR(13)||CHR(10)||'   C.ORDINE'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9518 as ID_MDTABLE,
  '6' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab. 8 ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  8 as ORDINE,
  '1' as STATUT,
  'DECLARE CURSOR C IS'||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'    FROM  ( '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'   :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'        ''''||''~''||TTT.ORDINE||SUM(ROWNUM)  AS NR_ROW, '||CHR(13)||CHR(10)||'     TTT.ORDINE  AS ORDINE,  '||CHR(13)||CHR(10)||'     ''1111'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     TTT.DENUMIRE NUME_ROW, '||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)   +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL1,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)) / CR.COL1 )/1000,1) AS COL2,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL3,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END )  ) / CR.COL1)/1000,1) AS COL4'||CHR(13)||CHR(10)||'     FROM DATA_ALL D'||CHR(13)||CHR(10)||'          INNER JOIN RENIM RN ON D.CUIIO = RN.CUIIO AND D.CUIIO_VERS = RN.CUIIO_VERS'||CHR(13)||CHR(10)||'          INNER  JOIN VW_CL_CUATM CT ON RN.CUATM = CT.CODUL'||CHR(13)||CHR(10)||'          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'          INNER  JOIN MD_CAPITOL MC ON MR.CAPITOL = MC.CAPITOL AND MR.CAPITOL_VERS = MC.CAPITOL_VERS'||CHR(13)||CHR(10)||'          INNER JOIN   USER_BANCU.VW_CL_TARI TT  ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'          INNER JOIN   USER_BANCU.VW_CL_TARI TTT ON (TT.FULL_CODE LIKE ''%'' ||TTT.CODUL||'';%'' )  '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)  AND'||CHR(13)||CHR(10)||'  MC.CAPITOL IN (409,410,411,403)'||CHR(13)||CHR(10)||'  GROUP BY'||CHR(13)||CHR(10)||'  TTT.ORDINE,'||CHR(13)||CHR(10)||'  TTT.FULL_CODE,'||CHR(13)||CHR(10)||'  TTT.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) DF;'||CHR(13)||CHR(10)||'  BEGIN'||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  USER_BANCU.TABLE_OUT ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4 )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9519 as ID_MDTABLE,
  '7' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.10 ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  10.02 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'   ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'CASE WHEN     CODUL IN ('||CHR(13)||CHR(10)||'        SELECT '||CHR(13)||CHR(10)||'        CODUL'||CHR(13)||CHR(10)||'          FROM USER_BANCU.CL_TARI'||CHR(13)||CHR(10)||'        )       THEN  '' ''||''~''||ROWNUM ELSE      REPLACE(SUBSTR(CODUL,3,9),0)||''~''||ROWNUM  END NR_ROW,'||CHR(13)||CHR(10)||'ROWNUM ORDINE,'||CHR(13)||CHR(10)||' ''1111'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'COL1,'||CHR(13)||CHR(10)||'COL2,'||CHR(13)||CHR(10)||'COL3,'||CHR(13)||CHR(10)||'COL4'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' SELECT  '||CHR(13)||CHR(10)||'    CODUL,'||CHR(13)||CHR(10)||'    DENUMIRE,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    COL3,'||CHR(13)||CHR(10)||'    COL4'||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||' ('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     ''1'' ORDINE,'||CHR(13)||CHR(10)||'     TTT.ORDINE  ORDINE_CL, '||CHR(13)||CHR(10)||'     TTT.DENUMIRE,'||CHR(13)||CHR(10)||'     TTT.CODUL CODUL,'||CHR(13)||CHR(10)||'     TTT.FULL_CODE,'||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)   +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL1,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)) / CR.COL1 )/1000,1) AS COL2,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL3,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END )  ) / CR.COL1)/1000,1) AS COL4'||CHR(13)||CHR(10)||'    FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'      -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')                      '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------      '||CHR(13)||CHR(10)||'       INNER JOIN   USER_BANCU.VW_CL_TARI TT ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'       INNER JOIN   ('||CHR(13)||CHR(10)||'       SELECT c.codul,'||CHR(13)||CHR(10)||'            c.denumire,'||CHR(13)||CHR(10)||'            c.grupa,'||CHR(13)||CHR(10)||'            c.ordine,'||CHR(13)||CHR(10)||'            c.full_code'||CHR(13)||CHR(10)||'       FROM (SELECT c1.codul,'||CHR(13)||CHR(10)||'                    c1.denumire,'||CHR(13)||CHR(10)||'                    c1.grupa,'||CHR(13)||CHR(10)||'                    c1.ordine,'||CHR(13)||CHR(10)||'                       TRIM (TO_CHAR (c3.codul, ''000''))'||CHR(13)||CHR(10)||'                    || '';'''||CHR(13)||CHR(10)||'                    || DECODE (c3.codul,'||CHR(13)||CHR(10)||'                               c2.codul, '''','||CHR(13)||CHR(10)||'                               TRIM (TO_CHAR (c2.codul, ''000'')) || '';'')'||CHR(13)||CHR(10)||'                    || DECODE (c2.codul,'||CHR(13)||CHR(10)||'                               c1.codul, '''','||CHR(13)||CHR(10)||'                               TRIM (TO_CHAR (c1.codul, ''000'')) || '';'')'||CHR(13)||CHR(10)||'                       AS full_code'||CHR(13)||CHR(10)||'               FROM ('||CHR(13)||CHR(10)||'              SELECT '||CHR(13)||CHR(10)||'              RIND    CODUL, '||CHR(13)||CHR(10)||'              DENUMIRE, '||CHR(13)||CHR(10)||'              RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'              ORDINE'||CHR(13)||CHR(10)||'   FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'         WHERE '||CHR(13)||CHR(10)||'         ID_MDTABLE IN (8170) '||CHR(13)||CHR(10)||'             ) c1'||CHR(13)||CHR(10)||'                    INNER JOIN  ('||CHR(13)||CHR(10)||'                 SELECT '||CHR(13)||CHR(10)||'                   RIND    CODUL, '||CHR(13)||CHR(10)||'                   DENUMIRE, '||CHR(13)||CHR(10)||'                   RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'                   ORDINE'||CHR(13)||CHR(10)||'                FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'                  WHERE '||CHR(13)||CHR(10)||'               ID_MDTABLE IN (8170) )'||CHR(13)||CHR(10)||'                     c2 ON (c1.grupa = c2.codul)'||CHR(13)||CHR(10)||'                    INNER JOIN ('||CHR(13)||CHR(10)||'          SELECT '||CHR(13)||CHR(10)||'           RIND    CODUL, '||CHR(13)||CHR(10)||'           DENUMIRE, '||CHR(13)||CHR(10)||'           RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'           ORDINE'||CHR(13)||CHR(10)||'            FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'             WHERE '||CHR(13)||CHR(10)||'              ID_MDTABLE IN (8170) '||CHR(13)||CHR(10)||'                      ) c3 ON (c2.grupa = c3.codul)) c'||CHR(13)||CHR(10)||'   ORDER BY c.ordine, c.full_code'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       ) TTT ON (TT.FULL_CODE LIKE ''%'' ||TTT.CODUL||'';%'' )  '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'         INNER  JOIN MD_CAPITOL MC ON MR.CAPITOL = MC.CAPITOL AND MR.CAPITOL_VERS = MC.CAPITOL_VERS'||CHR(13)||CHR(10)||'             '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410,411,403)'||CHR(13)||CHR(10)||'  AND TTT.CODUL NOT IN (''555'',''444'')'||CHR(13)||CHR(10)||'   GROUP BY'||CHR(13)||CHR(10)||'  TTT.DENUMIRE,'||CHR(13)||CHR(10)||'  TTT.CODUL,'||CHR(13)||CHR(10)||'  TTT.FULL_CODE,'||CHR(13)||CHR(10)||'  TTT.ORDINE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' UNION ALL'||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    ''2'' ORDINE,'||CHR(13)||CHR(10)||'      TTT.ORDINE  ORDINE_CL, '||CHR(13)||CHR(10)||'     SSS.DENUMIRE,'||CHR(13)||CHR(10)||'     2||''_''||SSS.CODUL,'||CHR(13)||CHR(10)||'     TTT.FULL_CODE,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)   +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL1,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END)) / CR.COL1 )/1000,1) AS COL2,'||CHR(13)||CHR(10)||'     ROUND((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END ))/1000,1) AS COL3,'||CHR(13)||CHR(10)||'     ROUND(((SUM(CASE WHEN  MC.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END) +'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  MC.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'')  THEN USER_BANCU.NVAL(D.COL4) ELSE 0 END )  ) / CR.COL1)/1000,1) AS COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     FROM USER_BANCU.DATA_ALL D  '||CHR(13)||CHR(10)||'      -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        INNER JOIN   USER_BANCU.VW_CL_TARI TT ON (TT.CODUL=D.COL3)'||CHR(13)||CHR(10)||'       INNER JOIN   ('||CHR(13)||CHR(10)||'       SELECT c.codul,'||CHR(13)||CHR(10)||'            c.denumire,'||CHR(13)||CHR(10)||'            c.grupa,'||CHR(13)||CHR(10)||'            c.ordine,'||CHR(13)||CHR(10)||'            c.full_code'||CHR(13)||CHR(10)||'       FROM (SELECT c1.codul,'||CHR(13)||CHR(10)||'                    c1.denumire,'||CHR(13)||CHR(10)||'                    c1.grupa,'||CHR(13)||CHR(10)||'                    c1.ordine,'||CHR(13)||CHR(10)||'                       TRIM (TO_CHAR (c3.codul, ''000''))'||CHR(13)||CHR(10)||'                    || '';'''||CHR(13)||CHR(10)||'                    || DECODE (c3.codul,'||CHR(13)||CHR(10)||'                               c2.codul, '''','||CHR(13)||CHR(10)||'                               TRIM (TO_CHAR (c2.codul, ''000'')) || '';'')'||CHR(13)||CHR(10)||'                    || DECODE (c2.codul,'||CHR(13)||CHR(10)||'                               c1.codul, '''','||CHR(13)||CHR(10)||'                               TRIM (TO_CHAR (c1.codul, ''000'')) || '';'')'||CHR(13)||CHR(10)||'                       AS full_code'||CHR(13)||CHR(10)||'               FROM ('||CHR(13)||CHR(10)||'              SELECT '||CHR(13)||CHR(10)||'              RIND    CODUL, '||CHR(13)||CHR(10)||'              DENUMIRE, '||CHR(13)||CHR(10)||'              RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'              ORDINE'||CHR(13)||CHR(10)||'   FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'         WHERE '||CHR(13)||CHR(10)||'         ID_MDTABLE IN (8170) '||CHR(13)||CHR(10)||'             ) c1'||CHR(13)||CHR(10)||'                    INNER JOIN  ('||CHR(13)||CHR(10)||'                 SELECT '||CHR(13)||CHR(10)||'                   RIND    CODUL, '||CHR(13)||CHR(10)||'                   DENUMIRE, '||CHR(13)||CHR(10)||'                   RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'                   ORDINE'||CHR(13)||CHR(10)||'                FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'                  WHERE '||CHR(13)||CHR(10)||'               ID_MDTABLE IN (8170) )'||CHR(13)||CHR(10)||'                     c2 ON (c1.grupa = c2.codul)'||CHR(13)||CHR(10)||'                    INNER JOIN ('||CHR(13)||CHR(10)||'          SELECT '||CHR(13)||CHR(10)||'           RIND    CODUL, '||CHR(13)||CHR(10)||'           DENUMIRE, '||CHR(13)||CHR(10)||'           RINDOUT  GRUPA,'||CHR(13)||CHR(10)||'           ORDINE'||CHR(13)||CHR(10)||'            FROM  USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'             WHERE '||CHR(13)||CHR(10)||'              ID_MDTABLE IN (8170) '||CHR(13)||CHR(10)||'                      ) c3 ON (c2.grupa = c3.codul)) c'||CHR(13)||CHR(10)||'   ORDER BY c.ordine, c.full_code'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       ) TTT ON (TT.FULL_CODE LIKE ''%'' ||TTT.CODUL||'';%'' )    '||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'         INNER JOIN   USER_BANCU.VW_CL_SERVICII SS ON ((RTRIM(SS.CODUL,''0'') )=D.COL1)     '||CHR(13)||CHR(10)||'         INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )    '||CHR(13)||CHR(10)||'         INNER  JOIN MD_CAPITOL MC ON MR.CAPITOL = MC.CAPITOL AND MR.CAPITOL_VERS = MC.CAPITOL_VERS'||CHR(13)||CHR(10)||'       -----------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)  AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410,411,403) AND '||CHR(13)||CHR(10)||'  TTT.CODUL NOT IN (''555'',''444'',''000'') AND '||CHR(13)||CHR(10)||'  SSS.CODUL NOT IN (''0000000'')'||CHR(13)||CHR(10)||'      GROUP BY'||CHR(13)||CHR(10)||'      TTT.CODUL, '||CHR(13)||CHR(10)||'      TTT.ORDINE,'||CHR(13)||CHR(10)||'      SSS.DENUMIRE,'||CHR(13)||CHR(10)||'      SSS.CODUL,'||CHR(13)||CHR(10)||'      TTT.FULL_CODE,'||CHR(13)||CHR(10)||'      CR.COL1 )'||CHR(13)||CHR(10)||'ORDER BY '||CHR(13)||CHR(10)||'    ORDINE_CL,'||CHR(13)||CHR(10)||'    FULL_CODE,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    CODUL )  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ) DF ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,  '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10523 as ID_MDTABLE,
  '8' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.12. Dupa fiecare codul serviciilor' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  12.61 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL1,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE    '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'   INSERT INTO   -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9521 as ID_MDTABLE,
  '8' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.12. Dupa fiecare codul serviciilor - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  12.6101 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7,'||CHR(13)||CHR(10)||'    DF.COL8'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(PACHET) COL1,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL7,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    NULL PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7, COL8'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7, CR.COL8'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  8 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10524 as ID_MDTABLE,
  'Tab.12.a' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.12.a Diferenta. Dupa fiecare codul serviciilor' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  12.62 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL1,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE    '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    HAVING '||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) <> 0'||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) <> 0'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'   INSERT INTO   -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  11079 as ID_MDTABLE,
  'Tab.12.a' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.12.a  Diferenta. Dupa fiecare codul serviciilor - old' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  12.621 as ORDINE,
  '3' as STATUT,
  ''||CHR(13)||CHR(10)||'INSERT INTO   -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL1,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE  '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    HAVING '||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) <> 0'||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) <> 0'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9509 as ID_MDTABLE,
  'Tab.12.a' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.12.a Diferenta. Dupa fiecare codul serviciilor - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  12.63 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7,'||CHR(13)||CHR(10)||'    DF.COL8'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(PACHET) COL1,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL7,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    NULL PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (409)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (410)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (405)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (406)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (405,406)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  HAVING '||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) <> 0'||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) <> 0'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7, COL8'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7, CR.COL8'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  8 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10525 as ID_MDTABLE,
  '10' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.13. Dupa fiecare codul serviciilor' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  13.02 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL1,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||'MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9525 as ID_MDTABLE,
  '10' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.13. Dupa fiecare codul serviciilor - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  13.021 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7,'||CHR(13)||CHR(10)||'    DF.COL8'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(PACHET) COL1,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL7,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    NULL PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||'  MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7, COL8'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7, CR.COL8'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  8 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10526 as ID_MDTABLE,
  '11' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.13.a Diferenta. Dupa fiecare codul serviciilor' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  13.03 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''0000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL1,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL7'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     HAVING '||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) <> 0'||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) <> 0'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  7 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9515 as ID_MDTABLE,
  '11' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.13.a Diferenta. Dupa fiecare codul serviciilor - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  13.04 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4,'||CHR(13)||CHR(10)||'    DF.COL5,'||CHR(13)||CHR(10)||'    DF.COL6,'||CHR(13)||CHR(10)||'    DF.COL7,'||CHR(13)||CHR(10)||'    DF.COL8'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM/0.123 NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(PACHET) COL1,'||CHR(13)||CHR(10)||'     TO_NUMBER(SERV_CODUL) COL2,'||CHR(13)||CHR(10)||'     ROUND(COL1,0) COL3,'||CHR(13)||CHR(10)||'     ROUND(COL2,0) COL4,'||CHR(13)||CHR(10)||'     ROUND(COL3,0) COL5,'||CHR(13)||CHR(10)||'     ROUND(COL4,0) COL6,'||CHR(13)||CHR(10)||'     ROUND(COL5,0) COL7,'||CHR(13)||CHR(10)||'     ROUND(COL6,0) COL8'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   ''1'' ORDINE,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    NULL PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'   00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   SSS.CODUL,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) A INNER JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  -- AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  B ON (B.CUIIO = B.CUIIO)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     A.CUIIO,'||CHR(13)||CHR(10)||'     A.SERV_CODUL,'||CHR(13)||CHR(10)||'     A.DENUMIRE'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     UNION '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     SELECT'||CHR(13)||CHR(10)||'    ''2'' ORDINE, '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SUM(A.COL1)  AS COL1,'||CHR(13)||CHR(10)||'    SUM(A.COL2)  AS COL2,'||CHR(13)||CHR(10)||'    SUM(B.COL1)  AS COL3,'||CHR(13)||CHR(10)||'    SUM(B.COL2)  AS COL4,'||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) AS COL5,'||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) AS COL6'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    ---------------------------------------------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN  MR.CAPITOL IN (411)  AND MR.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  MR.CAPITOL IN (403)  AND MR.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'FROM USER_BANCU.DATA_ALL D '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.VW_CL_CUATM C ON R.CUATM = C.CODUL'||CHR(13)||CHR(10)||'        INNER JOIN USER_BANCU.MD_RIND MR ON MR.ID_MD = D.ID_MD'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 )'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        -------------------------------------------------------------------------------'||CHR(13)||CHR(10)||'        CROSS JOIN ('||CHR(13)||CHR(10)||'         SELECT'||CHR(13)||CHR(10)||'            SUM(D.COL1) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                             (D.PERIOADA =:pPERIOADA) AND               '||CHR(13)||CHR(10)||'                              D.FORM IN (100)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10003)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'') '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                              ) CR'||CHR(13)||CHR(10)||'        ------------------------------------------------------------------------------   '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (C.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46) AND'||CHR(13)||CHR(10)||'  MR.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'  -------------------------------------------------'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  A  LEFT JOIN '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||' CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL,'||CHR(13)||CHR(10)||' MAX(DENUMIRE)  DENUMIRE,'||CHR(13)||CHR(10)||' SUM(COL1) AS COL1,'||CHR(13)||CHR(10)||'SUM(COL2) AS COL2'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    D.PERIOADA,'||CHR(13)||CHR(10)||'    D.CUIIO AS CUIIO,'||CHR(13)||CHR(10)||'    SS.CODUL   SERV_CODUL, '||CHR(13)||CHR(10)||'    SS.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ROUND((SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) AND  D.CAPITOL IN (407)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4)  AND  D.CAPITOL IN (408)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) / CR.COL1,0)'||CHR(13)||CHR(10)||'    AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'    INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    LEFT JOIN ('||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    SELECT'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            D.PERIOADA,'||CHR(13)||CHR(10)||'            SUM(CASE WHEN   P.PERIOADA_ANULA = :pPERIOADA AND P.NUM IN (1,2,3,4) THEN D.COL1 ELSE NULL  END ) AS COL1            '||CHR(13)||CHR(10)||'                  FROM DATA_ALL D'||CHR(13)||CHR(10)||'                          INNER  JOIN MD_RIND MR ON D.ID_MD = MR.ID_MD'||CHR(13)||CHR(10)||'                          INNER JOIN USER_BANCU.VW_MD_PERIOADA P ON (D.PERIOADA=P.PERIOADA) '||CHR(13)||CHR(10)||'                      '||CHR(13)||CHR(10)||'                        WHERE'||CHR(13)||CHR(10)||'                              P.PERIOADA_ANULA = :pPERIOADA AND            '||CHR(13)||CHR(10)||'                              D.FORM IN (101)'||CHR(13)||CHR(10)||'                              AND D.CUIIO IN (5)'||CHR(13)||CHR(10)||'                              AND MR.CAPITOL IN (10002)'||CHR(13)||CHR(10)||'                              AND MR.RIND IN (''01'')'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            GROUP BY '||CHR(13)||CHR(10)||'            D.PERIOADA '||CHR(13)||CHR(10)||'    )    CR  ON (D.PERIOADA=CR.PERIOADA)'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   WHERE        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  (D.FORM = 44) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS = 1004) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.FORM IN (44) AND D.CAPITOL IN (407,408)) AND '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  P.PERIOADA_ANULA = :pPERIOADA'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'   AND SS.CODUL <> ''0'''||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  GROUP BY  '||CHR(13)||CHR(10)||'  D.PERIOADA,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  SS.CODUL,'||CHR(13)||CHR(10)||'  SS.DENUMIRE,'||CHR(13)||CHR(10)||'  CR.COL1'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CUIIO,'||CHR(13)||CHR(10)||' SERV_CODUL'||CHR(13)||CHR(10)||' --,'||CHR(13)||CHR(10)||' --DENUMIRE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) B ON (B.CUIIO = A.CUIIO  AND B.SERV_CODUL  = A.SERV_CODUL)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    A.CUIIO, '||CHR(13)||CHR(10)||'    A.PACHET,'||CHR(13)||CHR(10)||'    A.SERV_CODUL,'||CHR(13)||CHR(10)||'    A.DENUMIRE'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'HAVING '||CHR(13)||CHR(10)||'    SUM(A.COL1) - SUM(B.COL1) <> 0'||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    SUM(A.COL2) - SUM(B.COL2) <> 0'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'  ) DF'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ;'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5, COL6, COL7, COL8'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4, CR.COL5, CR.COL6, CR.COL7, CR.COL8'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  8 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10527 as ID_MDTABLE,
  '12' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.14 ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  14.16 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     SERV_CODUL COL1,'||CHR(13)||CHR(10)||'     COL1 COL2,'||CHR(13)||CHR(10)||'     COL2 COL3,'||CHR(13)||CHR(10)||'     COL3 COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' SELECT '||CHR(13)||CHR(10)||'   ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    CC.CODUL  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'---'||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'           ---'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA =:pPERIOADA) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA BETWEEN FLOOR(:pPERIOADA/4)*4 AND :pPERIOADA)  AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||' AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.CODUL,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9526 as ID_MDTABLE,
  '12' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.14 - Pachet ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  14.1601 as ORDINE,
  '1' as STATUT,
  'INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(TRIM(PACHET)) AS COL1,'||CHR(13)||CHR(10)||'     SERV_CODUL COL2,'||CHR(13)||CHR(10)||'     COL1 COL3,'||CHR(13)||CHR(10)||'     COL2 COL4,'||CHR(13)||CHR(10)||'     COL3 COL5'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' SELECT '||CHR(13)||CHR(10)||'   ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    CC.CODUL  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    0 AS PACHET,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'---'||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'           ---'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA =:pPERIOADA) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA BETWEEN FLOOR(:pPERIOADA/4)*4 AND :pPERIOADA)  AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||' AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||' AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.CODUL,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.ORDINE,'||CHR(13)||CHR(10)||'L.CUATM_CODUL,'||CHR(13)||CHR(10)||'L.FULL_CODE,'||CHR(13)||CHR(10)||'L.DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2,'||CHR(13)||CHR(10)||'L.COL3'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  5 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10528 as ID_MDTABLE,
  '13' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.14 a ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  14.161 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     SERV_CODUL COL1,'||CHR(13)||CHR(10)||'     COL1 COL2,'||CHR(13)||CHR(10)||'     COL2 COL3,'||CHR(13)||CHR(10)||'     COL3 COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  HAVING '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9513 as ID_MDTABLE,
  '13' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.14 a  - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  14.162 as ORDINE,
  '1' as STATUT,
  'INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(TRIM(PACHET)) AS COL1,'||CHR(13)||CHR(10)||'     SERV_CODUL COL2,'||CHR(13)||CHR(10)||'     COL1 COL3,'||CHR(13)||CHR(10)||'     COL2 COL4,'||CHR(13)||CHR(10)||'     COL3 COL5'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.ORDINE,'||CHR(13)||CHR(10)||'L.CUATM_CODUL,'||CHR(13)||CHR(10)||'L.FULL_CODE,'||CHR(13)||CHR(10)||'L.DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2,'||CHR(13)||CHR(10)||'L.COL3'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (409,410)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  HAVING '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (409)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (410)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  5 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10529 as ID_MDTABLE,
  '14' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.15 ' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  15.1 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     SERV_CODUL COL1,'||CHR(13)||CHR(10)||'     COL1 COL2,'||CHR(13)||CHR(10)||'     COL2 COL3,'||CHR(13)||CHR(10)||'     COL3 COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' SELECT '||CHR(13)||CHR(10)||'   ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    CC.CODUL  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'---'||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'           ---'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA =:pPERIOADA) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA BETWEEN FLOOR(:pPERIOADA/4)*4 AND :pPERIOADA)  AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||' AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.CODUL,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL)  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9527 as ID_MDTABLE,
  '14' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.15 - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  15.11 as ORDINE,
  '1' as STATUT,
  'INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(TRIM(PACHET)) AS COL1,'||CHR(13)||CHR(10)||'     SERV_CODUL COL2,'||CHR(13)||CHR(10)||'     COL1 COL3,'||CHR(13)||CHR(10)||'     COL2 COL4,'||CHR(13)||CHR(10)||'     COL3 COL5'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' SELECT '||CHR(13)||CHR(10)||'   ''1'' AS ORDINE, '||CHR(13)||CHR(10)||'    CC.CODUL  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    00000000 AS CUIIO,'||CHR(13)||CHR(10)||'    0 AS PACHET,'||CHR(13)||CHR(10)||'    ''0''   SERV_CODUL, '||CHR(13)||CHR(10)||'    SSS.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'          '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   INNER JOIN USER_BANCU.VW_CL_SERVICII SS ON (rtrim(SS.CODUL, ''0'')=D.COL1 ) '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    INNER JOIN   USER_BANCU.VW_CL_SERVICII SSS ON (SS.FULL_CODE LIKE ''%'' ||SSS.CODUL||'';%'' )'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'---'||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'            INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' )'||CHR(13)||CHR(10)||'           ---'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA =:pPERIOADA) AND'||CHR(13)||CHR(10)||'  --(D.PERIOADA BETWEEN FLOOR(:pPERIOADA/4)*4 AND :pPERIOADA)  AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||' AND  SSS.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||' AND CC.CODUL IN (''0000000'')'||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'   CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE, '||CHR(13)||CHR(10)||'  SSS.CODUL,'||CHR(13)||CHR(10)||'  SSS.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.ORDINE,'||CHR(13)||CHR(10)||'L.CUATM_CODUL,'||CHR(13)||CHR(10)||'L.FULL_CODE,'||CHR(13)||CHR(10)||'L.DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2,'||CHR(13)||CHR(10)||'L.COL3'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4030000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  5 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9514 as ID_MDTABLE,
  '15' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.15 a' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  15.41 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''00000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     SERV_CODUL COL1,'||CHR(13)||CHR(10)||'     COL1 COL2,'||CHR(13)||CHR(10)||'     COL2 COL3,'||CHR(13)||CHR(10)||'     COL3 COL4'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL)  CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4100000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  HAVING '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||') DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10530 as ID_MDTABLE,
  '15' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.15 a - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  15.42 as ORDINE,
  '1' as STATUT,
  'INSERT INTO -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3,  COL4, COL5'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'     CUATM_CODUL AS NR_SECTIE,'||CHR(13)||CHR(10)||'     CUATM_CODUL||''-''||DENUMIRE_CUATM AS NUME_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'     CUIIO||''~''|| ROWNUM NR_ROW,'||CHR(13)||CHR(10)||'     ROWNUM  AS ORDINE,'||CHR(13)||CHR(10)||'     ''000000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'     DENUMIRE NUME_ROW,'||CHR(13)||CHR(10)||'     TO_NUMBER(TRIM(PACHET)) AS COL1,'||CHR(13)||CHR(10)||'     SERV_CODUL COL2,'||CHR(13)||CHR(10)||'     COL1 COL3,'||CHR(13)||CHR(10)||'     COL2 COL4,'||CHR(13)||CHR(10)||'     COL3 COL5'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    FROM  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'L.ORDINE,'||CHR(13)||CHR(10)||'L.CUATM_CODUL,'||CHR(13)||CHR(10)||'L.FULL_CODE,'||CHR(13)||CHR(10)||'L.DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'L.CUIIO,'||CHR(13)||CHR(10)||'R.PACHET,'||CHR(13)||CHR(10)||'L.SERV_CODUL,'||CHR(13)||CHR(10)||'L.DENUMIRE,'||CHR(13)||CHR(10)||'L.COL1,'||CHR(13)||CHR(10)||'L.COL2,'||CHR(13)||CHR(10)||'L.COL3'||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    ''2'' AS ORDINE,'||CHR(13)||CHR(10)||'    MAX(CC.CODUL) CUATM_CODUL,'||CHR(13)||CHR(10)||'    CC.FULL_CODE,'||CHR(13)||CHR(10)||'    CC.DENUMIRE DENUMIRE_CUATM,'||CHR(13)||CHR(10)||'    D.CUIIO,'||CHR(13)||CHR(10)||'    S.CODUL    SERV_CODUL,'||CHR(13)||CHR(10)||'    S.DENUMIRE||''-''||MAX(R.DENUMIRE) DENUMIRE,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL1,'||CHR(13)||CHR(10)||'        (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    AS COL2,'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D '||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.CL_SERVICII S ON (S.CODUL=D.COL1)'||CHR(13)||CHR(10)||'     INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM C ON (D.CUATM=C.CODUL) '||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM CC ON (C.FULL_CODE LIKE ''%''||CC.CODUL ||'';%'' ) '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA IN(:pPERIOADA,:pPERIOADA-1)) AND    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND S.CODUL <> ''0'''||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  AND CC.CODUL  IN  ( ''0000000'','||CHR(13)||CHR(10)||'   --''0100000'','||CHR(13)||CHR(10)||'    ''0110000'','||CHR(13)||CHR(10)||'    ''0120000'','||CHR(13)||CHR(10)||'    ''0130000'','||CHR(13)||CHR(10)||'    ''0140000'','||CHR(13)||CHR(10)||'    ''0150000'','||CHR(13)||CHR(10)||'    --''1111111'''||CHR(13)||CHR(10)||'    ''3000000'','||CHR(13)||CHR(10)||'    ''1400000'','||CHR(13)||CHR(10)||'    ''3400000'','||CHR(13)||CHR(10)||'    ''3600000'','||CHR(13)||CHR(10)||'    ''4030000'','||CHR(13)||CHR(10)||'    ''4300000'','||CHR(13)||CHR(10)||'    ''4500000'','||CHR(13)||CHR(10)||'    ''4800000'','||CHR(13)||CHR(10)||'    ''6200000'','||CHR(13)||CHR(10)||'    ''7100000'','||CHR(13)||CHR(10)||'    ''7400000'','||CHR(13)||CHR(10)||'    ''7800000'','||CHR(13)||CHR(10)||'--2222222'||CHR(13)||CHR(10)||'    ''1000000'','||CHR(13)||CHR(10)||'    ''2500000'','||CHR(13)||CHR(10)||'    ''3100000'','||CHR(13)||CHR(10)||'    ''3800000'','||CHR(13)||CHR(10)||'    ''5300000'','||CHR(13)||CHR(10)||'    ''5500000'','||CHR(13)||CHR(10)||'    ''6000000'','||CHR(13)||CHR(10)||'    ''6400000'','||CHR(13)||CHR(10)||'    ''6700000'','||CHR(13)||CHR(10)||'    ''8000000'','||CHR(13)||CHR(10)||'    ''8300000'','||CHR(13)||CHR(10)||'    ''8900000'','||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    --3333333'||CHR(13)||CHR(10)||'    ''1200000'','||CHR(13)||CHR(10)||'    ''1700000'','||CHR(13)||CHR(10)||'    ''2100000'','||CHR(13)||CHR(10)||'    ''2700000'','||CHR(13)||CHR(10)||'    ''2900000'','||CHR(13)||CHR(10)||'    ''5700000'','||CHR(13)||CHR(10)||'    ''8500000'','||CHR(13)||CHR(10)||'    ''8700000'','||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''9200000'','||CHR(13)||CHR(10)||'    ''9601000'','||CHR(13)||CHR(10)||'    ''9602000'','||CHR(13)||CHR(10)||'    ''9603000'''||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'--  CC.CODUL,'||CHR(13)||CHR(10)||'  CC.FULL_CODE,'||CHR(13)||CHR(10)||'  CC.DENUMIRE,'||CHR(13)||CHR(10)||'  D.CUIIO,'||CHR(13)||CHR(10)||'  S.CODUL,'||CHR(13)||CHR(10)||'  S.DENUMIRE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   HAVING '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    OR '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'     (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA-1) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA-1) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END ))'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'    -'||CHR(13)||CHR(10)||'    (SUM(CASE WHEN D.PERIOADA IN(:pPERIOADA) AND  D.CAPITOL IN (411)  AND D.RIND NOT IN (''1'',''2'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )  '||CHR(13)||CHR(10)||'    +'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  D.PERIOADA IN(:pPERIOADA) AND   D.CAPITOL IN (403)  AND D.RIND NOT IN (''1'',''-'') AND D.COL4 IS NOT NULL THEN D.COL4 ELSE 0 END )) >  500000'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'         SELECT '||CHR(13)||CHR(10)||'                    DISTINCT  D.CUIIO,'||CHR(13)||CHR(10)||'                    D.PACHET'||CHR(13)||CHR(10)||'                    FROM USER_BANCU.DATA_ALL  D '||CHR(13)||CHR(10)||'                                INNER JOIN MD_RIND  R ON R.ID_MD = D.ID_MD '||CHR(13)||CHR(10)||'                    '||CHR(13)||CHR(10)||'                    WHERE '||CHR(13)||CHR(10)||'                    D.FORM = 46'||CHR(13)||CHR(10)||'                    AND D.PERIOADA IN(:pPERIOADA)'||CHR(13)||CHR(10)||'                    AND R.CAPITOL IN  (1)'||CHR(13)||CHR(10)||'                   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   )  R ON R.CUIIO = L.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ORDER BY  ORDINE'||CHR(13)||CHR(10)||'  )'||CHR(13)||CHR(10)||'  ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  5 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9516 as ID_MDTABLE,
  'Tab.18 ' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.18' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  18 as ORDINE,
  '1' as STATUT,
  'INSERT INTO TABLE_OUT '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'  PERIOADA,'||CHR(13)||CHR(10)||'  FORM,'||CHR(13)||CHR(10)||'  FORM_VERS,'||CHR(13)||CHR(10)||'  ID_MDTABLE,'||CHR(13)||CHR(10)||'  COD_CUATM,'||CHR(13)||CHR(10)||'  NR_SECTIE,'||CHR(13)||CHR(10)||'  NUME_SECTIE,'||CHR(13)||CHR(10)||'  NR_SECTIE1,'||CHR(13)||CHR(10)||'  NUME_SECTIE1,'||CHR(13)||CHR(10)||'  NR_SECTIE2,'||CHR(13)||CHR(10)||'  NUME_SECTIE2,'||CHR(13)||CHR(10)||'  NR_ROW,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  DECIMAL_POS,'||CHR(13)||CHR(10)||'  NUME_ROW,  '||CHR(13)||CHR(10)||' COL1,COL2,COL3, COL4'||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'  :pFORM AS FORM,'||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   A.CUIIO||''~''||ROWNUM AS NR_ROW,'||CHR(13)||CHR(10)||'   ROWNUM AS ORDINE, '||CHR(13)||CHR(10)||'  ''0000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'   NUME_ROW,'||CHR(13)||CHR(10)||'   SUBSTR(A.CAEM2,2,4) AS COL1,'||CHR(13)||CHR(10)||'   A.PACHET AS COL2,'||CHR(13)||CHR(10)||'   ROUND(A.COL1,1) AS COL3,'||CHR(13)||CHR(10)||'   ROUND(A.COL2,1) AS COL4'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'   SELECT'||CHR(13)||CHR(10)||'   L.CUIIO,'||CHR(13)||CHR(10)||'   L.NUME_ROW, '||CHR(13)||CHR(10)||'   L.RIND,'||CHR(13)||CHR(10)||'   L.CAEM2,'||CHR(13)||CHR(10)||'   L.PACHET,'||CHR(13)||CHR(10)||'   L.COL1  AS COL1,'||CHR(13)||CHR(10)||'   R.COL1  AS COL2'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'   R.CUIIO,'||CHR(13)||CHR(10)||'   MAX(R.DENUMIRE) AS NUME_ROW, '||CHR(13)||CHR(10)||'   D.RIND,'||CHR(13)||CHR(10)||'   D.CAEM2,'||CHR(13)||CHR(10)||'   D.PACHET,'||CHR(13)||CHR(10)||'   ROUND(SUM(CASE WHEN D.PERIOADA IN (:pPERIOADA) THEN D.RIND ELSE NULL END),1) AS COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO= D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  D.FORM IN (46)                           AND '||CHR(13)||CHR(10)||'  D.FORM_VERS = :pFORM_VERS                AND    '||CHR(13)||CHR(10)||'  D.CAPITOL IN (1)                         AND '||CHR(13)||CHR(10)||'  D.PERIOADA IN (:pPERIOADA) AND '||CHR(13)||CHR(10)||'  D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%''  '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' -- AND D.CUIIO IN (13557) '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND,'||CHR(13)||CHR(10)||'  D.CAEM2,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'   R.CUIIO,'||CHR(13)||CHR(10)||'   MAX(R.DENUMIRE) AS NUME_ROW, '||CHR(13)||CHR(10)||'   D.RIND,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   D.CAEM2,'||CHR(13)||CHR(10)||'   D.PACHET,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN 1=1  THEN D.RIND ELSE NULL END) AS COL1'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO= D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'                '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'         INNER JOIN'||CHR(13)||CHR(10)||'         ('||CHR(13)||CHR(10)||'           SELECT P.PERIOADA FROM USER_BANCU.VW_MD_PERIOADA P '||CHR(13)||CHR(10)||'           WHERE P.PERIOADA = :pPERIOADA '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'           UNION   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'           SELECT P.PERIOADA  '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           FROM USER_BANCU.VW_MD_PERIOADA P '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           INNER JOIN USER_BANCU.VW_MD_PERIOADA T ON(P.ANUL=T.ANUL AND P.TIP_PERIOADA=5 )'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'           WHERE T.PERIOADA = :pPERIOADA'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           AND P.NUM = 4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'        ) P ON(D.PERIOADA=P.PERIOADA)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  D.FORM IN (44)                           AND '||CHR(13)||CHR(10)||' -- D.FORM_VERS = :pFORM_VERS                AND    '||CHR(13)||CHR(10)||'  D.CAPITOL IN (1)                         AND '||CHR(13)||CHR(10)||' -- D.PERIOADA IN (:pPERIOADA) AND '||CHR(13)||CHR(10)||'  D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%''  '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' -- AND D.CUIIO IN (13557) '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND,'||CHR(13)||CHR(10)||'  D.CAEM2,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  R ON R.CUIIO = L.CUIIO '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) A' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9517 as ID_MDTABLE,
  'Tab.19' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.19' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  19 as ORDINE,
  '1' as STATUT,
  'INSERT INTO TABLE_OUT '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'  PERIOADA,'||CHR(13)||CHR(10)||'  FORM,'||CHR(13)||CHR(10)||'  FORM_VERS,'||CHR(13)||CHR(10)||'  ID_MDTABLE,'||CHR(13)||CHR(10)||'  COD_CUATM,'||CHR(13)||CHR(10)||'  NR_SECTIE,'||CHR(13)||CHR(10)||'  NUME_SECTIE,'||CHR(13)||CHR(10)||'  NR_SECTIE1,'||CHR(13)||CHR(10)||'  NUME_SECTIE1,'||CHR(13)||CHR(10)||'  NR_SECTIE2,'||CHR(13)||CHR(10)||'  NUME_SECTIE2,'||CHR(13)||CHR(10)||'  NR_ROW,'||CHR(13)||CHR(10)||'  ORDINE,'||CHR(13)||CHR(10)||'  DECIMAL_POS,'||CHR(13)||CHR(10)||'  NUME_ROW,  '||CHR(13)||CHR(10)||' COL1,COL2,COL3, COL4'||CHR(13)||CHR(10)||')'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'  :pFORM AS FORM,'||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   A.CUIIO||''~''||ROWNUM AS NR_ROW,'||CHR(13)||CHR(10)||'   ROWNUM AS ORDINE, '||CHR(13)||CHR(10)||'  ''0000'' AS DECIMAL_POS,'||CHR(13)||CHR(10)||'   NUME_ROW,'||CHR(13)||CHR(10)||'   SUBSTR(A.CAEM2,2,4) AS COL1,'||CHR(13)||CHR(10)||'   A.PACHET AS COL2,'||CHR(13)||CHR(10)||'   ROUND(A.COL1,1) AS COL3,'||CHR(13)||CHR(10)||'   ROUND(A.COL2,1) AS COL4'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'   SELECT'||CHR(13)||CHR(10)||'   L.CUIIO,'||CHR(13)||CHR(10)||'   L.NUME_ROW, '||CHR(13)||CHR(10)||'   L.RIND,'||CHR(13)||CHR(10)||'   L.CAEM2,'||CHR(13)||CHR(10)||'   L.PACHET,'||CHR(13)||CHR(10)||'   L.COL1  AS COL1,'||CHR(13)||CHR(10)||'   R.COL1  AS COL2'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   FROM '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'   R.CUIIO,'||CHR(13)||CHR(10)||'   MAX(R.DENUMIRE) AS NUME_ROW, '||CHR(13)||CHR(10)||'   D.RIND,'||CHR(13)||CHR(10)||'   D.CAEM2,'||CHR(13)||CHR(10)||'   D.PACHET,'||CHR(13)||CHR(10)||'   ROUND(SUM(CASE WHEN D.PERIOADA IN (:pPERIOADA) THEN D.RIND ELSE NULL END),1) AS COL1'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO= D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  D.FORM IN (46)                           AND '||CHR(13)||CHR(10)||'  D.FORM_VERS = :pFORM_VERS                AND    '||CHR(13)||CHR(10)||'  D.CAPITOL IN (404)                         AND '||CHR(13)||CHR(10)||'  D.PERIOADA IN (:pPERIOADA) AND '||CHR(13)||CHR(10)||'  D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%''  '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' -- AND D.CUIIO IN (13557) '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND,'||CHR(13)||CHR(10)||'  D.CAEM2,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) L LEFT JOIN ('||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'   R.CUIIO,'||CHR(13)||CHR(10)||'   MAX(R.DENUMIRE) AS NUME_ROW, '||CHR(13)||CHR(10)||'   D.RIND,'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   D.CAEM2,'||CHR(13)||CHR(10)||'   D.PACHET,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN 1=1  THEN D.RIND ELSE NULL END) AS COL1'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'         INNER JOIN USER_BANCU.RENIM R ON (R.CUIIO= D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'                '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'         INNER JOIN'||CHR(13)||CHR(10)||'         ('||CHR(13)||CHR(10)||'           SELECT P.PERIOADA FROM USER_BANCU.VW_MD_PERIOADA P '||CHR(13)||CHR(10)||'           WHERE P.PERIOADA = :pPERIOADA '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'           UNION   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'           SELECT P.PERIOADA  '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           FROM USER_BANCU.VW_MD_PERIOADA P '||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           INNER JOIN USER_BANCU.VW_MD_PERIOADA T ON(P.ANUL=T.ANUL AND P.TIP_PERIOADA=5 )'||CHR(13)||CHR(10)||'            '||CHR(13)||CHR(10)||'           WHERE T.PERIOADA = :pPERIOADA'||CHR(13)||CHR(10)||'           '||CHR(13)||CHR(10)||'           AND P.NUM = 4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'        ) P ON(D.PERIOADA=P.PERIOADA)'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  D.FORM IN (44)                           AND '||CHR(13)||CHR(10)||' -- D.FORM_VERS = :pFORM_VERS                AND    '||CHR(13)||CHR(10)||'  D.CAPITOL IN (14)                         AND '||CHR(13)||CHR(10)||' -- D.PERIOADA IN (:pPERIOADA) AND '||CHR(13)||CHR(10)||'  D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%''  '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||' -- AND D.CUIIO IN (13557) '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND,'||CHR(13)||CHR(10)||'  D.CAEM2,'||CHR(13)||CHR(10)||'  D.PACHET'||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  D.RIND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  )  R ON R.CUIIO = L.CUIIO '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) A' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9512 as ID_MDTABLE,
  'Tab.20 a' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.20 a' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  20.1 as ORDINE,
  '1' as STATUT,
  '  INSERT INTO TABLE_OUT'||CHR(13)||CHR(10)||'(   '||CHR(13)||CHR(10)||'    PERIOADA,'||CHR(13)||CHR(10)||'    FORM,'||CHR(13)||CHR(10)||'    FORM_VERS,'||CHR(13)||CHR(10)||'    ID_MDTABLE,'||CHR(13)||CHR(10)||'    COD_CUATM,'||CHR(13)||CHR(10)||'    NR_SECTIE,'||CHR(13)||CHR(10)||'    NUME_SECTIE,'||CHR(13)||CHR(10)||'    NR_SECTIE1,'||CHR(13)||CHR(10)||'    NUME_SECTIE1,'||CHR(13)||CHR(10)||'    NR_SECTIE2,'||CHR(13)||CHR(10)||'    NUME_SECTIE2,'||CHR(13)||CHR(10)||'    NR_ROW,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    DECIMAL_POS,'||CHR(13)||CHR(10)||'    NUME_ROW,'||CHR(13)||CHR(10)||'    COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0''  AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,    '||CHR(13)||CHR(10)||'        COL1||''~''||ROWNUM   NR_ROW,        '||CHR(13)||CHR(10)||'        ROWNUM   ORDINE,'||CHR(13)||CHR(10)||'        ''0'' DECIMAL_POS,'||CHR(13)||CHR(10)||'        DENUMIRE NUME_ROW ,'||CHR(13)||CHR(10)||'        COL2'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       ''0'' ORDINE,'||CHR(13)||CHR(10)||'       ''Numarul intreprinderilor (total):'' DENUMIRE,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        (SELECT '||CHR(13)||CHR(10)||'       COUNT ( F.CUIIO)  AS CNT'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     FROM USER_BANCU.FORM_CUIIO F'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'        INNER JOIN '||CHR(13)||CHR(10)||'      ('||CHR(13)||CHR(10)||'      SELECT '||CHR(13)||CHR(10)||'        CUIIO, '||CHR(13)||CHR(10)||'        MAX(CUIIO_VERS) AS CUIIO_VERS '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'      FROM USER_BANCU.FORM_CUIIO FC'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE  '||CHR(13)||CHR(10)||'      1=1 '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      GROUP BY '||CHR(13)||CHR(10)||'      CUIIO '||CHR(13)||CHR(10)||'      ) FF ON (FF.CUIIO = F.CUIIO AND F.CUIIO_VERS = FF.CUIIO_VERS)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      LEFT  JOIN USER_BANCU.RENIM R ON (R.CUIIO  = F.CUIIO  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'                                   AND  R.CUIIO_VERS   = F.CUIIO_VERS )'||CHR(13)||CHR(10)||'      LEFT JOIN USER_BANCU.VW_CL_CUATM CT ON (R.CUATM = CT.CODUL)    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      F.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      AND F.STATUT <> ''3'''||CHR(13)||CHR(10)||'      AND CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%''  ) COL1,'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      (SELECT '||CHR(13)||CHR(10)||'       COUNT ( F.CUIIO)  AS CNT'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     FROM USER_BANCU.FORM_CUIIO F'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'        INNER JOIN '||CHR(13)||CHR(10)||'      ('||CHR(13)||CHR(10)||'      SELECT '||CHR(13)||CHR(10)||'        CUIIO, '||CHR(13)||CHR(10)||'        MAX(CUIIO_VERS) AS CUIIO_VERS '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'      FROM USER_BANCU.FORM_CUIIO FC'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE  '||CHR(13)||CHR(10)||'      1=1 '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.CUIIO_VERS <= :pPERIOADA - 1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      GROUP BY '||CHR(13)||CHR(10)||'      CUIIO '||CHR(13)||CHR(10)||'      ) FF ON (FF.CUIIO = F.CUIIO AND F.CUIIO_VERS = FF.CUIIO_VERS)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      LEFT  JOIN USER_BANCU.RENIM R ON (R.CUIIO  = F.CUIIO  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'                                   AND  R.CUIIO_VERS   = F.CUIIO_VERS )'||CHR(13)||CHR(10)||'      LEFT JOIN USER_BANCU.VW_CL_CUATM CT ON (R.CUATM = CT.CODUL)    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      F.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      AND F.STATUT <> ''3'''||CHR(13)||CHR(10)||'      AND CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%''  ) COL2'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      FROM DUAL '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''1'' ORDINE,'||CHR(13)||CHR(10)||'    ''Numarul rapoartelor redactate:'' DENUMIRE,'||CHR(13)||CHR(10)||'    COUNT (DISTINCT CASE WHEN D.PERIOADA IN (:pPERIOADA) THEN D.CUIIO  END) AS COL1,'||CHR(13)||CHR(10)||'    COUNT (DISTINCT CASE WHEN D.PERIOADA IN (:pPERIOADA-1) THEN  D.CUIIO END) AS COL2'||CHR(13)||CHR(10)||'    FROM USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  WHERE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (1,409,410,404,411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''2'' ORDINE,'||CHR(13)||CHR(10)||'    ''Numarul rapoartelor eronate:'' DENUMIRE,'||CHR(13)||CHR(10)||'    COUNT(DISTINCT CASE WHEN PERIOADA IN (:pPERIOADA) THEN CUIIO END) AS COL1,'||CHR(13)||CHR(10)||'    COUNT(DISTINCT CASE WHEN PERIOADA IN (:pPERIOADA - 1) THEN CUIIO END) AS COL12'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM USER_BANCU.CONTROL'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    WHERE '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FORM = 46'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    AND REZULTAT <> ''OK'''||CHR(13)||CHR(10)||'    AND PERIOADA IN (:pPERIOADA,:pPERIOADA-1)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            3||''_''||RIND ORDINE,'||CHR(13)||CHR(10)||'            DENUMIRE,'||CHR(13)||CHR(10)||'            COL1, '||CHR(13)||CHR(10)||'            COL2  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           FROM'||CHR(13)||CHR(10)||'            ('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'                SELECT '||CHR(13)||CHR(10)||'                     '||CHR(13)||CHR(10)||'                '||CHR(13)||CHR(10)||'                           A.RIND,         '||CHR(13)||CHR(10)||'                           CASE WHEN A.RIND = ''01'' THEN ''01 - ''||A.DENUMIRE  '||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''02'' THEN ''02 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''03'' THEN ''03 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''04'' THEN ''04 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''05'' THEN ''05 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''06'' THEN ''06 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''07'' THEN ''07 - ''||A.DENUMIRE  '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            ELSE A.DENUMIRE  END DENUMIRE, '||CHR(13)||CHR(10)||'                            B.COL1,'||CHR(13)||CHR(10)||'                            B.COL2     '||CHR(13)||CHR(10)||'                     '||CHR(13)||CHR(10)||'                     FROM    '||CHR(13)||CHR(10)||'                   (         '||CHR(13)||CHR(10)||'                     SELECT '||CHR(13)||CHR(10)||'                            R.RIND,'||CHR(13)||CHR(10)||'                            R.RIND_VERS,'||CHR(13)||CHR(10)||'                            R.DENUMIRE     '||CHR(13)||CHR(10)||'                                 '||CHR(13)||CHR(10)||'                            FROM '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            (   '||CHR(13)||CHR(10)||'                            SELECT '||CHR(13)||CHR(10)||'                            R.RIND          RIND,'||CHR(13)||CHR(10)||'                            R.RIND_VERS     RIND_VERS,'||CHR(13)||CHR(10)||'                            R.DENUMIRE      DENUMIRE'||CHR(13)||CHR(10)||'                               '||CHR(13)||CHR(10)||'                            FROM USER_BANCU.MD_RIND R'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            INNER JOIN (                  '||CHR(13)||CHR(10)||'                            SELECT '||CHR(13)||CHR(10)||'                            R.RIND,'||CHR(13)||CHR(10)||'                            MAX(R.RIND_VERS) AS RIND_VERS'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            FROM USER_BANCU.MD_RIND R '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            WHERE '||CHR(13)||CHR(10)||'                            R.RIND_VERS <=:pPERIOADA'||CHR(13)||CHR(10)||'                            AND  (R.FORM =:pFORM) AND '||CHR(13)||CHR(10)||'                            (R.FORM_VERS =:pFORM_VERS) AND'||CHR(13)||CHR(10)||'                            (:pID_MDTABLE=:pID_MDTABLE) AND '||CHR(13)||CHR(10)||'                             R.FORM = 46  AND '||CHR(13)||CHR(10)||'                             R.CAPITOL IN (1) AND '||CHR(13)||CHR(10)||'                             R.RIND NOT IN  (''CD'',''-'',''CM'')   '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            GROUP BY '||CHR(13)||CHR(10)||'                            R.RIND'||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                             ) RR   ON (    RR.RIND      = R.RIND'||CHR(13)||CHR(10)||'                                       AND  RR.RIND_VERS = R.RIND_VERS)'||CHR(13)||CHR(10)||'                                       '||CHR(13)||CHR(10)||'                                       '||CHR(13)||CHR(10)||'                            WHERE'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                           (R.FORM =:pFORM) AND '||CHR(13)||CHR(10)||'                           (R.FORM_VERS =:pFORM_VERS) AND'||CHR(13)||CHR(10)||'                           (:pID_MDTABLE=:pID_MDTABLE) AND '||CHR(13)||CHR(10)||'                           R.FORM = 46  AND '||CHR(13)||CHR(10)||'                           R.CAPITOL IN (1) AND '||CHR(13)||CHR(10)||'                           R.RIND NOT IN  (''CD'',''-'',''CM'')                     '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           GROUP BY'||CHR(13)||CHR(10)||'                           R.RIND,'||CHR(13)||CHR(10)||'                           R.RIND_VERS,'||CHR(13)||CHR(10)||'                           R.DENUMIRE  ) R'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           R.RIND'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ) A  LEFT JOIN '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ('||CHR(13)||CHR(10)||'                           SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        MR.RIND,'||CHR(13)||CHR(10)||'        MR.RIND_VERS,'||CHR(13)||CHR(10)||'        MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'       SUM( CASE   WHEN D.PERIOADA IN (:pPERIOADA) AND   D.CUIIO = D.CUIIO AND D.COL1 = 1 THEN 1 ELSE NULL END)     AS COL1,'||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SUM( CASE   WHEN D.PERIOADA IN (:pPERIOADA-1) AND   D.CUIIO = D.CUIIO AND D.COL1 = 1 THEN 1 ELSE NULL END)   AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'FROM USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.MD_RIND MR ON (MR.ID_MD = D.ID_MD)  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||' (D.PERIOADA IN (:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (1)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP  BY '||CHR(13)||CHR(10)||'   MR.RIND,'||CHR(13)||CHR(10)||'   MR.RIND_VERS,'||CHR(13)||CHR(10)||'   MR.DENUMIRE'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ) B ON  '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ( '||CHR(13)||CHR(10)||'                           A.RIND  = B.RIND'||CHR(13)||CHR(10)||'                           AND A.RIND_VERS   = B.RIND_VERS )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           A.RIND'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           ORDINE' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  1 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9511 as ID_MDTABLE,
  'Tab.20 b' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.20 b' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  20.2 as ORDINE,
  '1' as STATUT,
  '  INSERT INTO TABLE_OUT'||CHR(13)||CHR(10)||'(   '||CHR(13)||CHR(10)||'    PERIOADA,'||CHR(13)||CHR(10)||'    FORM,'||CHR(13)||CHR(10)||'    FORM_VERS,'||CHR(13)||CHR(10)||'    ID_MDTABLE,'||CHR(13)||CHR(10)||'    COD_CUATM,'||CHR(13)||CHR(10)||'    NR_SECTIE,'||CHR(13)||CHR(10)||'    NUME_SECTIE,'||CHR(13)||CHR(10)||'    NR_SECTIE1,'||CHR(13)||CHR(10)||'    NUME_SECTIE1,'||CHR(13)||CHR(10)||'    NR_SECTIE2,'||CHR(13)||CHR(10)||'    NUME_SECTIE2,'||CHR(13)||CHR(10)||'    NR_ROW,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    DECIMAL_POS,'||CHR(13)||CHR(10)||'    NUME_ROW,'||CHR(13)||CHR(10)||'    COL1'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0''  AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,    '||CHR(13)||CHR(10)||'        COL1||''~''||ROWNUM   NR_ROW,        '||CHR(13)||CHR(10)||'        ROWNUM   ORDINE,'||CHR(13)||CHR(10)||'        ''0'' DECIMAL_POS,'||CHR(13)||CHR(10)||'        DENUMIRE NUME_ROW ,'||CHR(13)||CHR(10)||'        COL2'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'       ''0'' ORDINE,'||CHR(13)||CHR(10)||'       ''Numarul intreprinderilor (total):'' DENUMIRE,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'        (SELECT '||CHR(13)||CHR(10)||'       COUNT ( F.CUIIO)  AS CNT'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     FROM USER_BANCU.FORM_CUIIO F'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'        INNER JOIN '||CHR(13)||CHR(10)||'      ('||CHR(13)||CHR(10)||'      SELECT '||CHR(13)||CHR(10)||'        CUIIO, '||CHR(13)||CHR(10)||'        MAX(CUIIO_VERS) AS CUIIO_VERS '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'      FROM USER_BANCU.FORM_CUIIO FC'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE  '||CHR(13)||CHR(10)||'      1=1 '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      GROUP BY '||CHR(13)||CHR(10)||'      CUIIO '||CHR(13)||CHR(10)||'      ) FF ON (FF.CUIIO = F.CUIIO AND F.CUIIO_VERS = FF.CUIIO_VERS)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      LEFT  JOIN USER_BANCU.RENIM R ON (R.CUIIO  = F.CUIIO  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'                                   AND  R.CUIIO_VERS   = F.CUIIO_VERS )'||CHR(13)||CHR(10)||'      LEFT JOIN USER_BANCU.VW_CL_CUATM CT ON (R.CUATM = CT.CODUL)    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      F.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      AND F.STATUT <> ''3'''||CHR(13)||CHR(10)||'      AND CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%''  ) COL1,'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      (SELECT '||CHR(13)||CHR(10)||'       COUNT ( F.CUIIO)  AS CNT'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'     FROM USER_BANCU.FORM_CUIIO F'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'        INNER JOIN '||CHR(13)||CHR(10)||'      ('||CHR(13)||CHR(10)||'      SELECT '||CHR(13)||CHR(10)||'        CUIIO, '||CHR(13)||CHR(10)||'        MAX(CUIIO_VERS) AS CUIIO_VERS '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'      FROM USER_BANCU.FORM_CUIIO FC'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE  '||CHR(13)||CHR(10)||'      1=1 '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      AND FC.CUIIO_VERS <= :pPERIOADA - 1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      GROUP BY '||CHR(13)||CHR(10)||'      CUIIO '||CHR(13)||CHR(10)||'      ) FF ON (FF.CUIIO = F.CUIIO AND F.CUIIO_VERS = FF.CUIIO_VERS)'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      LEFT  JOIN USER_BANCU.RENIM R ON (R.CUIIO  = F.CUIIO  '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'                                   AND  R.CUIIO_VERS   = F.CUIIO_VERS )'||CHR(13)||CHR(10)||'      LEFT JOIN USER_BANCU.VW_CL_CUATM CT ON (R.CUATM = CT.CODUL)    '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      WHERE '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      F.FORM IN (:pFORM)'||CHR(13)||CHR(10)||'      AND F.STATUT <> ''3'''||CHR(13)||CHR(10)||'      AND CT.FULL_CODE LIKE ''%''||:pCOD_CUATM||'';%''  ) COL2'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      FROM DUAL  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''1'' ORDINE,'||CHR(13)||CHR(10)||'    ''Numarul rapoartelor redactate:'' DENUMIRE,'||CHR(13)||CHR(10)||'    COUNT (DISTINCT CASE WHEN D.PERIOADA IN (:pPERIOADA) THEN D.CUIIO  END) AS COL1,'||CHR(13)||CHR(10)||'    COUNT (DISTINCT CASE WHEN D.PERIOADA IN (:pPERIOADA-1) THEN  D.CUIIO END) AS COL2'||CHR(13)||CHR(10)||'    FROM USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  WHERE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (1,409,410,404,411,403)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    ''2'' ORDINE,'||CHR(13)||CHR(10)||'    ''Numarul rapoartelor eronate:'' DENUMIRE,'||CHR(13)||CHR(10)||'    COUNT(DISTINCT CASE WHEN PERIOADA IN (:pPERIOADA) THEN CUIIO END) AS COL1,'||CHR(13)||CHR(10)||'    COUNT(DISTINCT CASE WHEN PERIOADA IN (:pPERIOADA - 1) THEN CUIIO END) AS COL12'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FROM USER_BANCU.CONTROL'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    WHERE '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    FORM = 46'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    AND REZULTAT <> ''OK'''||CHR(13)||CHR(10)||'    AND PERIOADA IN (:pPERIOADA,:pPERIOADA-1)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  UNION '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  SELECT'||CHR(13)||CHR(10)||'            3||''_''||RIND ORDINE,'||CHR(13)||CHR(10)||'            DENUMIRE,'||CHR(13)||CHR(10)||'            COL1, '||CHR(13)||CHR(10)||'            COL2  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'           FROM'||CHR(13)||CHR(10)||'            ('||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'                SELECT '||CHR(13)||CHR(10)||'                     '||CHR(13)||CHR(10)||'                '||CHR(13)||CHR(10)||'                           A.RIND,         '||CHR(13)||CHR(10)||'                           CASE WHEN A.RIND = ''01'' THEN ''01 - ''||A.DENUMIRE  '||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''02'' THEN ''02 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''03'' THEN ''03 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''04'' THEN ''04 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''05'' THEN ''05 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''06'' THEN ''06 - ''||A.DENUMIRE'||CHR(13)||CHR(10)||'                                 WHEN A.RIND = ''07'' THEN ''07 - ''||A.DENUMIRE  '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            ELSE A.DENUMIRE  END DENUMIRE, '||CHR(13)||CHR(10)||'                            B.COL1,'||CHR(13)||CHR(10)||'                            B.COL2     '||CHR(13)||CHR(10)||'                     '||CHR(13)||CHR(10)||'                     FROM    '||CHR(13)||CHR(10)||'                   (         '||CHR(13)||CHR(10)||'                     SELECT '||CHR(13)||CHR(10)||'                            R.RIND,'||CHR(13)||CHR(10)||'                            R.RIND_VERS,'||CHR(13)||CHR(10)||'                            R.DENUMIRE     '||CHR(13)||CHR(10)||'                                 '||CHR(13)||CHR(10)||'                            FROM '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            (   '||CHR(13)||CHR(10)||'                            SELECT '||CHR(13)||CHR(10)||'                            R.RIND          RIND,'||CHR(13)||CHR(10)||'                            R.RIND_VERS     RIND_VERS,'||CHR(13)||CHR(10)||'                            R.DENUMIRE      DENUMIRE'||CHR(13)||CHR(10)||'                               '||CHR(13)||CHR(10)||'                            FROM USER_BANCU.MD_RIND R'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            INNER JOIN (                  '||CHR(13)||CHR(10)||'                            SELECT '||CHR(13)||CHR(10)||'                            R.RIND,'||CHR(13)||CHR(10)||'                            MAX(R.RIND_VERS) AS RIND_VERS'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            FROM USER_BANCU.MD_RIND R '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            WHERE '||CHR(13)||CHR(10)||'                            R.RIND_VERS <=:pPERIOADA'||CHR(13)||CHR(10)||'                            AND  (R.FORM =:pFORM) AND '||CHR(13)||CHR(10)||'                            (R.FORM_VERS =:pFORM_VERS) AND'||CHR(13)||CHR(10)||'                            (:pID_MDTABLE=:pID_MDTABLE) AND '||CHR(13)||CHR(10)||'                             R.FORM = 46  AND '||CHR(13)||CHR(10)||'                             R.CAPITOL IN (404) AND '||CHR(13)||CHR(10)||'                             R.RIND NOT IN  (''CD'',''-'',''CM'')   '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                            GROUP BY '||CHR(13)||CHR(10)||'                            R.RIND'||CHR(13)||CHR(10)||'                              '||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                             ) RR   ON (    RR.RIND      = R.RIND'||CHR(13)||CHR(10)||'                                       AND  RR.RIND_VERS = R.RIND_VERS)'||CHR(13)||CHR(10)||'                                       '||CHR(13)||CHR(10)||'                                       '||CHR(13)||CHR(10)||'                            WHERE'||CHR(13)||CHR(10)||'                            '||CHR(13)||CHR(10)||'                           (R.FORM =:pFORM) AND '||CHR(13)||CHR(10)||'                           (R.FORM_VERS =:pFORM_VERS) AND'||CHR(13)||CHR(10)||'                           (:pID_MDTABLE=:pID_MDTABLE) AND '||CHR(13)||CHR(10)||'                           R.FORM = 46  AND '||CHR(13)||CHR(10)||'                           R.CAPITOL IN (404) AND '||CHR(13)||CHR(10)||'                           R.RIND NOT IN  (''CD'',''-'',''CM'')                     '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           GROUP BY'||CHR(13)||CHR(10)||'                           R.RIND,'||CHR(13)||CHR(10)||'                           R.RIND_VERS,'||CHR(13)||CHR(10)||'                           R.DENUMIRE  ) R'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           R.RIND'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ) A  LEFT JOIN '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ('||CHR(13)||CHR(10)||'                           SELECT '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'        MR.RIND,'||CHR(13)||CHR(10)||'        MR.RIND_VERS,'||CHR(13)||CHR(10)||'        MR.DENUMIRE DENUMIRE,'||CHR(13)||CHR(10)||'       SUM( CASE   WHEN D.PERIOADA IN (:pPERIOADA) AND   D.CUIIO = D.CUIIO AND D.COL1 = 1 THEN 1 ELSE NULL END)     AS COL1,'||CHR(13)||CHR(10)||'         '||CHR(13)||CHR(10)||'        SUM( CASE   WHEN D.PERIOADA IN (:pPERIOADA-1) AND   D.CUIIO = D.CUIIO AND D.COL1 = 1 THEN 1 ELSE NULL END)   AS COL2'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'FROM USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.MD_RIND MR ON (MR.ID_MD = D.ID_MD)  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' WHERE'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||' (D.PERIOADA IN (:pPERIOADA,:pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  D.FORM IN (46)'||CHR(13)||CHR(10)||'  AND'||CHR(13)||CHR(10)||'  D.CAPITOL IN (404)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP  BY '||CHR(13)||CHR(10)||'   MR.RIND,'||CHR(13)||CHR(10)||'   MR.RIND_VERS,'||CHR(13)||CHR(10)||'   MR.DENUMIRE'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ) B ON  '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ( '||CHR(13)||CHR(10)||'                           A.RIND  = B.RIND'||CHR(13)||CHR(10)||'                           AND A.RIND_VERS   = B.RIND_VERS )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           A.RIND'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           )'||CHR(13)||CHR(10)||'                           '||CHR(13)||CHR(10)||'                           ORDER BY '||CHR(13)||CHR(10)||'                           ORDINE' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  1 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10531 as ID_MDTABLE,
  '21' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.21 a' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  21.1 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT DISTINCT                                                                   '||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,                                                    '||CHR(13)||CHR(10)||'  :pFORM AS FORM,                                                            '||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,                                                  '||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,                                                '||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,                                                  '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,                                                         '||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,                                                        '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   R.CUATM||''~''||R.CUIIO AS NR_ROW, '||CHR(13)||CHR(10)||'   0 AS ORDINE,'||CHR(13)||CHR(10)||'  ''000'' AS DECIMAL_POS,  '||CHR(13)||CHR(10)||'   R.DENUMIRE||'' CAEM: ''||R.CAEM2||'')'' AS NUME_ROW,'||CHR(13)||CHR(10)||'   R.CUIIO AS COL1,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.RIND ELSE NULL END) AS COL2,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA-1 THEN D.RIND ELSE NULL END) AS COL3  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  DISTINCT'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CUIIO_VERS,'||CHR(13)||CHR(10)||'  R.DENUMIRE  DENUMIRE,'||CHR(13)||CHR(10)||'  F.FORM,'||CHR(13)||CHR(10)||'  R.CAEM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.FORM_CUIIO F ON (R.CUIIO=F.CUIIO AND R.CUIIO_VERS=F.CUIIO_VERS)'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.VW_DATA_ALL J ON F.FORM = J.FORM AND F.CUIIO = J.CUIIO AND F.CUIIO_VERS = J.CUIIO_VERS'||CHR(13)||CHR(10)||'  INNER JOIN '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'      SELECT'||CHR(13)||CHR(10)||'      R.CUIIO,'||CHR(13)||CHR(10)||'      MAX(R.CUIIO_VERS) AS CUIIO_VERS'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'      USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'    WHERE'||CHR(13)||CHR(10)||'      R.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'    GROUP BY'||CHR(13)||CHR(10)||'      R.CUIIO'||CHR(13)||CHR(10)||'  ) D ON (R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  F.FORM IN (46) AND'||CHR(13)||CHR(10)||'  F.STATUT <> ''3'' AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (J.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') '||CHR(13)||CHR(10)||'  ORDER BY CAEM2 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) R ON R.FORM = D.FORM AND R.CUIIO = D.CUIIO AND D.CUIIO_VERS <= R.CUIIO_VERS'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  (D.FORM=:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS=:pFORM_VERS) AND'||CHR(13)||CHR(10)||'  (:pID_MDTABLE=:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND '||CHR(13)||CHR(10)||'   D.CAPITOL IN (1) AND'||CHR(13)||CHR(10)||'   D.RIND NOT IN (''CM'',''CD'',''DIH'') '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ) DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  3 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9504 as ID_MDTABLE,
  '21' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.21 a - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  21.11 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT DISTINCT                                                                   '||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,                                                    '||CHR(13)||CHR(10)||'  :pFORM AS FORM,                                                            '||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,                                                  '||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,                                                '||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,                                                  '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,                                                         '||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,                                                        '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   R.CUATM||''~''||R.CUIIO AS NR_ROW, '||CHR(13)||CHR(10)||'   0 AS ORDINE,'||CHR(13)||CHR(10)||'  ''0000'' AS DECIMAL_POS,  '||CHR(13)||CHR(10)||'   R.DENUMIRE||'' CAEM: ''||R.CAEM2||'')'' AS NUME_ROW,'||CHR(13)||CHR(10)||'   R.CUIIO AS COL1,'||CHR(13)||CHR(10)||'   MAX(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.PACHET ELSE D.PACHET END) AS COL2,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.RIND ELSE NULL END) AS COL3,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA-1 THEN D.RIND ELSE NULL END) AS COL4  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  DISTINCT'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CUIIO_VERS,'||CHR(13)||CHR(10)||'  R.DENUMIRE  DENUMIRE,'||CHR(13)||CHR(10)||'  F.FORM,'||CHR(13)||CHR(10)||'  R.CAEM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.FORM_CUIIO F ON (R.CUIIO=F.CUIIO AND R.CUIIO_VERS=F.CUIIO_VERS)'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.VW_DATA_ALL J ON F.FORM = J.FORM AND F.CUIIO = J.CUIIO AND F.CUIIO_VERS = J.CUIIO_VERS'||CHR(13)||CHR(10)||'  INNER JOIN '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'      SELECT'||CHR(13)||CHR(10)||'      R.CUIIO,'||CHR(13)||CHR(10)||'      MAX(R.CUIIO_VERS) AS CUIIO_VERS'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'      USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'    WHERE'||CHR(13)||CHR(10)||'      R.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'    GROUP BY'||CHR(13)||CHR(10)||'      R.CUIIO'||CHR(13)||CHR(10)||'  ) D ON (R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  F.FORM IN (46) AND'||CHR(13)||CHR(10)||'  F.STATUT <> ''3'' AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (J.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') '||CHR(13)||CHR(10)||'  ORDER BY CAEM2 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) R ON R.FORM = D.FORM AND R.CUIIO = D.CUIIO AND D.CUIIO_VERS <= R.CUIIO_VERS'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  (D.FORM=:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS=:pFORM_VERS) AND'||CHR(13)||CHR(10)||'  (:pID_MDTABLE=:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND '||CHR(13)||CHR(10)||'   D.CAPITOL IN (1) AND'||CHR(13)||CHR(10)||'   D.RIND NOT IN (''CM'',''CD'',''DIH'') '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ) DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3, COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9505 as ID_MDTABLE,
  '21b' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.21 b' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  21.2 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT DISTINCT                                                                   '||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,                                                    '||CHR(13)||CHR(10)||'  :pFORM AS FORM,                                                            '||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,                                                  '||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,                                                '||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,                                                  '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,                                                         '||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,                                                        '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   R.CUATM||''~''||R.CUIIO AS NR_ROW, '||CHR(13)||CHR(10)||'   0 AS ORDINE,'||CHR(13)||CHR(10)||'  ''000'' AS DECIMAL_POS,  '||CHR(13)||CHR(10)||'   R.DENUMIRE||'' CAEM: ''||R.CAEM2||'')'' AS NUME_ROW,'||CHR(13)||CHR(10)||'   R.CUIIO AS COL1,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.RIND ELSE NULL END) AS COL2,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA-1 THEN D.RIND ELSE NULL END) AS COL3  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  DISTINCT'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CUIIO_VERS,'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  F.FORM,'||CHR(13)||CHR(10)||'  R.CAEM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.FORM_CUIIO F ON (R.CUIIO=F.CUIIO AND R.CUIIO_VERS=F.CUIIO_VERS)'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.VW_DATA_ALL J ON F.FORM = J.FORM AND F.CUIIO = J.CUIIO AND F.CUIIO_VERS = J.CUIIO_VERS'||CHR(13)||CHR(10)||'  INNER JOIN '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'      SELECT'||CHR(13)||CHR(10)||'      R.CUIIO,'||CHR(13)||CHR(10)||'      MAX(R.CUIIO_VERS) AS CUIIO_VERS'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'      USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'    WHERE'||CHR(13)||CHR(10)||'      R.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'    GROUP BY'||CHR(13)||CHR(10)||'      R.CUIIO'||CHR(13)||CHR(10)||'  ) D ON (R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  F.FORM IN (46) AND'||CHR(13)||CHR(10)||'  F.STATUT <> ''3'' AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (J.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') '||CHR(13)||CHR(10)||'  ORDER BY CAEM2 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) R ON R.FORM = D.FORM AND R.CUIIO = D.CUIIO AND D.CUIIO_VERS <= R.CUIIO_VERS'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  (D.FORM=:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS=:pFORM_VERS) AND'||CHR(13)||CHR(10)||'  (:pID_MDTABLE=:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND '||CHR(13)||CHR(10)||'   D.CAPITOL IN (404) AND'||CHR(13)||CHR(10)||'   D.RIND NOT IN (''CM'',''CD'',''DIH'') '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ) DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  3 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  10532 as ID_MDTABLE,
  '21b' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.21 b - Pachet' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  21.21 as ORDINE,
  '1' as STATUT,
  'DECLARE'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  CURSOR C IS'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    DF.PERIOADA,'||CHR(13)||CHR(10)||'    DF.FORM,'||CHR(13)||CHR(10)||'    DF.FORM_VERS,'||CHR(13)||CHR(10)||'    DF.ID_MDTABLE,'||CHR(13)||CHR(10)||'    DF.COD_CUATM,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE1,'||CHR(13)||CHR(10)||'    DF.NR_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NUME_SECTIE2,'||CHR(13)||CHR(10)||'    DF.NR_ROW NR_ROW,'||CHR(13)||CHR(10)||'    DF.ORDINE,'||CHR(13)||CHR(10)||'    DF.DECIMAL_POS,'||CHR(13)||CHR(10)||'    DF.NUME_ROW,'||CHR(13)||CHR(10)||'    DF.COL1,'||CHR(13)||CHR(10)||'    DF.COL2,'||CHR(13)||CHR(10)||'    DF.COL3,'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    DF.COL4'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'FROM '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT DISTINCT                                                                   '||CHR(13)||CHR(10)||'  :pPERIOADA AS PERIOADA,                                                    '||CHR(13)||CHR(10)||'  :pFORM AS FORM,                                                            '||CHR(13)||CHR(10)||'  :pFORM_VERS AS FORM_VERS,                                                  '||CHR(13)||CHR(10)||'  :pID_MDTABLE AS ID_MDTABLE,                                                '||CHR(13)||CHR(10)||'  :pCOD_CUATM AS COD_CUATM,                                                  '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE,                                                         '||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE,                                                        '||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'  ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'  ''0'' AS NUME_SECTIE2,'||CHR(13)||CHR(10)||'   R.CUATM||''~''||R.CUIIO AS NR_ROW, '||CHR(13)||CHR(10)||'   0 AS ORDINE,'||CHR(13)||CHR(10)||'  ''0000'' AS DECIMAL_POS,  '||CHR(13)||CHR(10)||'   R.DENUMIRE||'' CAEM: ''||R.CAEM2||'')'' AS NUME_ROW,'||CHR(13)||CHR(10)||'   R.CUIIO AS COL1,'||CHR(13)||CHR(10)||'   MAX(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.PACHET ELSE D.PACHET END) AS COL2,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA   THEN D.RIND ELSE NULL END) AS COL3,'||CHR(13)||CHR(10)||'   SUM(CASE WHEN D.PERIOADA IN :pPERIOADA-1 THEN D.RIND ELSE NULL END) AS COL4  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'  INNER JOIN ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT'||CHR(13)||CHR(10)||'  DISTINCT'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CUIIO_VERS,'||CHR(13)||CHR(10)||'  R.DENUMIRE  DENUMIRE,'||CHR(13)||CHR(10)||'  F.FORM,'||CHR(13)||CHR(10)||'  R.CAEM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'FROM'||CHR(13)||CHR(10)||'  USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.FORM_CUIIO F ON (R.CUIIO=F.CUIIO AND R.CUIIO_VERS=F.CUIIO_VERS)'||CHR(13)||CHR(10)||'  INNER JOIN USER_BANCU.VW_DATA_ALL J ON F.FORM = J.FORM AND F.CUIIO = J.CUIIO AND F.CUIIO_VERS = J.CUIIO_VERS'||CHR(13)||CHR(10)||'  INNER JOIN '||CHR(13)||CHR(10)||'  ('||CHR(13)||CHR(10)||'      SELECT'||CHR(13)||CHR(10)||'      R.CUIIO,'||CHR(13)||CHR(10)||'      MAX(R.CUIIO_VERS) AS CUIIO_VERS'||CHR(13)||CHR(10)||'    FROM'||CHR(13)||CHR(10)||'      USER_BANCU.RENIM R'||CHR(13)||CHR(10)||'    WHERE'||CHR(13)||CHR(10)||'      R.CUIIO_VERS <= :pPERIOADA'||CHR(13)||CHR(10)||'    GROUP BY'||CHR(13)||CHR(10)||'      R.CUIIO'||CHR(13)||CHR(10)||'  ) D ON (R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS)'||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  F.FORM IN (46) AND'||CHR(13)||CHR(10)||'  F.STATUT <> ''3'' AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (J.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') '||CHR(13)||CHR(10)||'  ORDER BY CAEM2 '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) R ON R.FORM = D.FORM AND R.CUIIO = D.CUIIO AND D.CUIIO_VERS <= R.CUIIO_VERS'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'WHERE'||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'  (D.FORM=:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS=:pFORM_VERS) AND'||CHR(13)||CHR(10)||'  (:pID_MDTABLE=:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  (D.PERIOADA IN (:pPERIOADA, :pPERIOADA-1)) AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND '||CHR(13)||CHR(10)||'   D.CAPITOL IN (404) AND'||CHR(13)||CHR(10)||'   D.RIND NOT IN (''CM'',''CD'',''DIH'') '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'GROUP BY'||CHR(13)||CHR(10)||'  R.DENUMIRE,'||CHR(13)||CHR(10)||'  R.CUIIO,'||CHR(13)||CHR(10)||'  R.CUATM,'||CHR(13)||CHR(10)||'  R.CAEM2'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'ORDER BY'||CHR(13)||CHR(10)||'  R.CUIIO'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ) DF'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||';'||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'    BEGIN'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  FOR CR IN C'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  LOOP'||CHR(13)||CHR(10)||'    INSERT INTO  -- USER_BANCU.TABLE_OUT_TEST '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.TABLE_OUT'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      PERIOADA,'||CHR(13)||CHR(10)||'      FORM,'||CHR(13)||CHR(10)||'      FORM_VERS,'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'      ID_MDTABLE,'||CHR(13)||CHR(10)||'      COD_CUATM,'||CHR(13)||CHR(10)||'      NR_SECTIE,'||CHR(13)||CHR(10)||'      NUME_SECTIE,'||CHR(13)||CHR(10)||'      NR_SECTIE1,'||CHR(13)||CHR(10)||'      NUME_SECTIE1,'||CHR(13)||CHR(10)||'      NR_SECTIE2,'||CHR(13)||CHR(10)||'      NUME_SECTIE2,'||CHR(13)||CHR(10)||'      NR_ROW,'||CHR(13)||CHR(10)||'      ORDINE,'||CHR(13)||CHR(10)||'      DECIMAL_POS,'||CHR(13)||CHR(10)||'      NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      COL1, COL2, COL3, COL4'||CHR(13)||CHR(10)||'    )'||CHR(13)||CHR(10)||'    VALUES'||CHR(13)||CHR(10)||'    ('||CHR(13)||CHR(10)||'      CR.PERIOADA,'||CHR(13)||CHR(10)||'      CR.FORM,'||CHR(13)||CHR(10)||'      CR.FORM_VERS,'||CHR(13)||CHR(10)||'      CR.ID_MDTABLE,'||CHR(13)||CHR(10)||'      CR.COD_CUATM,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE1,'||CHR(13)||CHR(10)||'      CR.NR_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NUME_SECTIE2,'||CHR(13)||CHR(10)||'      CR.NR_ROW,'||CHR(13)||CHR(10)||'      CR.ORDINE,'||CHR(13)||CHR(10)||'      CR.DECIMAL_POS,'||CHR(13)||CHR(10)||'      CR.NUME_ROW,'||CHR(13)||CHR(10)||'       '||CHR(13)||CHR(10)||'      CR.COL1, CR.COL2, CR.COL3, CR.COL4'||CHR(13)||CHR(10)||'    );'||CHR(13)||CHR(10)||'  END LOOP;'||CHR(13)||CHR(10)||'END;'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   '||CHR(13)||CHR(10)||'   ' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  4 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9523 as ID_MDTABLE,
  'Tab.22' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.22' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  22 as ORDINE,
  '1' as STATUT,
  '  INSERT INTO TABLE_OUT'||CHR(13)||CHR(10)||'(   '||CHR(13)||CHR(10)||'    PERIOADA,'||CHR(13)||CHR(10)||'    FORM,'||CHR(13)||CHR(10)||'    FORM_VERS,'||CHR(13)||CHR(10)||'    ID_MDTABLE,'||CHR(13)||CHR(10)||'    COD_CUATM,'||CHR(13)||CHR(10)||'    NR_SECTIE,'||CHR(13)||CHR(10)||'    NUME_SECTIE,'||CHR(13)||CHR(10)||'    NR_SECTIE1,'||CHR(13)||CHR(10)||'    NUME_SECTIE1,'||CHR(13)||CHR(10)||'    NR_SECTIE2,'||CHR(13)||CHR(10)||'    NUME_SECTIE2,'||CHR(13)||CHR(10)||'    NR_ROW,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    DECIMAL_POS,'||CHR(13)||CHR(10)||'    NUME_ROW,'||CHR(13)||CHR(10)||'    COL1'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0''  AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,    '||CHR(13)||CHR(10)||'        AA.COL1||''~''||ROWNUM   NR_ROW,        '||CHR(13)||CHR(10)||'        ROWNUM   ORDINE,'||CHR(13)||CHR(10)||'        ''0'' DECIMAL_POS,'||CHR(13)||CHR(10)||'        AA.NUME_ROW  NUME_ROW ,'||CHR(13)||CHR(10)||'        AA.COL2  AS COL1'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     FROM'||CHR(13)||CHR(10)||'     ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     CD.NR_ROW   AS NR_ROW,'||CHR(13)||CHR(10)||'     CD.NR_ROW   AS ORDINE,'||CHR(13)||CHR(10)||'     CD.NUME_ROW AS NUME_ROW,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL1,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL2,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL4'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM VC ON (VC.CODUL=D.CUATM)'||CHR(13)||CHR(10)||'      CROSS JOIN  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'   SELECT '||CHR(13)||CHR(10)||'         DENUMIRE           NUME_ROW,'||CHR(13)||CHR(10)||'         RIND               NR_ROW,'||CHR(13)||CHR(10)||'         RINDOUT           CUATM'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        FROM USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        WHERE '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        ID_MDTABLE = 8096'||CHR(13)||CHR(10)||'   )'||CHR(13)||CHR(10)||'   CD'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND D.CAPITOL IN (1,404)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'    CD.NR_ROW,'||CHR(13)||CHR(10)||'    CD.NUME_ROW'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'    ORDER BY '||CHR(13)||CHR(10)||'    CD.NR_ROW'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) AA '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ORDER BY AA.ORDINE' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  1 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9520 as ID_MDTABLE,
  'Tab.22 a' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.22 a' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  22.2 as ORDINE,
  '1' as STATUT,
  '  INSERT INTO TABLE_OUT'||CHR(13)||CHR(10)||'(   '||CHR(13)||CHR(10)||'    PERIOADA,'||CHR(13)||CHR(10)||'    FORM,'||CHR(13)||CHR(10)||'    FORM_VERS,'||CHR(13)||CHR(10)||'    ID_MDTABLE,'||CHR(13)||CHR(10)||'    COD_CUATM,'||CHR(13)||CHR(10)||'    NR_SECTIE,'||CHR(13)||CHR(10)||'    NUME_SECTIE,'||CHR(13)||CHR(10)||'    NR_SECTIE1,'||CHR(13)||CHR(10)||'    NUME_SECTIE1,'||CHR(13)||CHR(10)||'    NR_SECTIE2,'||CHR(13)||CHR(10)||'    NUME_SECTIE2,'||CHR(13)||CHR(10)||'    NR_ROW,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    DECIMAL_POS,'||CHR(13)||CHR(10)||'    NUME_ROW,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    COL3'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0''  AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,    '||CHR(13)||CHR(10)||'        AA.COL1||''~''||ROWNUM   NR_ROW,        '||CHR(13)||CHR(10)||'        ROWNUM   ORDINE,'||CHR(13)||CHR(10)||'        ''000'' DECIMAL_POS,'||CHR(13)||CHR(10)||'        AA.NUME_ROW  NUME_ROW ,'||CHR(13)||CHR(10)||'        AA.COL2  AS COL1,'||CHR(13)||CHR(10)||'        AA.COL3  AS COL2,'||CHR(13)||CHR(10)||'        AA.COL4  AS COL3'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     FROM'||CHR(13)||CHR(10)||'     ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     CD.NR_ROW   AS NR_ROW,'||CHR(13)||CHR(10)||'     CD.NR_ROW   AS ORDINE,'||CHR(13)||CHR(10)||'     CD.NUME_ROW AS NUME_ROW,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL1,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL2,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL3,'||CHR(13)||CHR(10)||'    SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL4'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM VC ON (VC.CODUL=D.CUATM)'||CHR(13)||CHR(10)||'      CROSS JOIN  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'   SELECT '||CHR(13)||CHR(10)||'         DENUMIRE           NUME_ROW,'||CHR(13)||CHR(10)||'         RIND               NR_ROW,'||CHR(13)||CHR(10)||'         RINDOUT           CUATM'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        FROM USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        WHERE '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        ID_MDTABLE = 8096'||CHR(13)||CHR(10)||'   )'||CHR(13)||CHR(10)||'   CD'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND D.CAPITOL IN (1,404)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'    CD.NR_ROW,'||CHR(13)||CHR(10)||'    CD.NUME_ROW'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'    ORDER BY '||CHR(13)||CHR(10)||'    CD.NR_ROW'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  ) AA '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ORDER BY AA.ORDINE' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  3 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

MERGE INTO USER_BANCU.MD_TABLES A USING
 (SELECT
  9522 as ID_MDTABLE,
  'Tab.22 b' as TABELE,
  2008 as TABELE_VERS,
  46 as FORM,
  2000 as FORM_VERS,
  'Tab.22 b' as DEN_SHORT,
  '2' as NIVELRAIONAL,
  22.3 as ORDINE,
  '1' as STATUT,
  '  INSERT INTO TABLE_OUT'||CHR(13)||CHR(10)||'(   '||CHR(13)||CHR(10)||'    PERIOADA,'||CHR(13)||CHR(10)||'    FORM,'||CHR(13)||CHR(10)||'    FORM_VERS,'||CHR(13)||CHR(10)||'    ID_MDTABLE,'||CHR(13)||CHR(10)||'    COD_CUATM,'||CHR(13)||CHR(10)||'    NR_SECTIE,'||CHR(13)||CHR(10)||'    NUME_SECTIE,'||CHR(13)||CHR(10)||'    NR_SECTIE1,'||CHR(13)||CHR(10)||'    NUME_SECTIE1,'||CHR(13)||CHR(10)||'    NR_SECTIE2,'||CHR(13)||CHR(10)||'    NUME_SECTIE2,'||CHR(13)||CHR(10)||'    NR_ROW,'||CHR(13)||CHR(10)||'    ORDINE,'||CHR(13)||CHR(10)||'    DECIMAL_POS,'||CHR(13)||CHR(10)||'    NUME_ROW,'||CHR(13)||CHR(10)||'    COL1,'||CHR(13)||CHR(10)||'    COL2,'||CHR(13)||CHR(10)||'    COL3,'||CHR(13)||CHR(10)||'    COL4,'||CHR(13)||CHR(10)||'    COL5,'||CHR(13)||CHR(10)||'    COL6,'||CHR(13)||CHR(10)||'    COL7,'||CHR(13)||CHR(10)||'    COL8,'||CHR(13)||CHR(10)||'    COL9,'||CHR(13)||CHR(10)||'    COL10,'||CHR(13)||CHR(10)||'    COL11,'||CHR(13)||CHR(10)||'    COL12,'||CHR(13)||CHR(10)||'    COL13'||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  ) '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'    :pPERIOADA AS PERIOADA,'||CHR(13)||CHR(10)||'    :pFORM AS FORM,'||CHR(13)||CHR(10)||'    :pFORM_VERS AS FORM_VERS,'||CHR(13)||CHR(10)||'    :pID_MDTABLE AS ID_MDTABLE,'||CHR(13)||CHR(10)||'    :pCOD_CUATM AS COD_CUATM,'||CHR(13)||CHR(10)||'    ''0''  AS NR_SECTIE,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE, '||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE1,'||CHR(13)||CHR(10)||'    ''0'' AS NR_SECTIE2,'||CHR(13)||CHR(10)||'    ''0'' AS NUME_SECTIE2,    '||CHR(13)||CHR(10)||'        AA.COL1||''~''||ROWNUM   NR_ROW,        '||CHR(13)||CHR(10)||'        ROWNUM   ORDINE,'||CHR(13)||CHR(10)||'        ''0000000000000'' DECIMAL_POS,'||CHR(13)||CHR(10)||'        AA.NUME_ROW  NUME_ROW ,'||CHR(13)||CHR(10)||'        AA.COL2   AS COL1,'||CHR(13)||CHR(10)||'        AA.COL3   AS COL2,'||CHR(13)||CHR(10)||'        AA.COL4   AS COL3,'||CHR(13)||CHR(10)||'        AA.COL5   AS COL4,'||CHR(13)||CHR(10)||'        AA.COL6   AS COL5,'||CHR(13)||CHR(10)||'        AA.COL7   AS COL6,'||CHR(13)||CHR(10)||'        AA.COL8   AS COL7,'||CHR(13)||CHR(10)||'        AA.COL9   AS COL8,'||CHR(13)||CHR(10)||'        AA.COL10  AS COL9,'||CHR(13)||CHR(10)||'        AA.COL11  AS COL10,'||CHR(13)||CHR(10)||'        AA.COL12  AS COL11,'||CHR(13)||CHR(10)||'        AA.COL13  AS COL12,'||CHR(13)||CHR(10)||'        AA.COL404  AS COL13'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'     FROM'||CHR(13)||CHR(10)||'     ('||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'SELECT '||CHR(13)||CHR(10)||'     CD.NR_ROW   AS NR_ROW,'||CHR(13)||CHR(10)||'     CD.NR_ROW   AS ORDINE,'||CHR(13)||CHR(10)||'     CD.NUME_ROW AS NUME_ROW,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL1,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''01'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL2,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''02'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL3,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''02'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL4,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''03'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL5,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''03'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL6,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''04'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL7,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''04'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL8,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL9,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''05'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL10,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''06'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL11,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''06'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL12,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (1)  AND D.RIND IN (''07'')  AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL13,'||CHR(13)||CHR(10)||'     SUM(CASE WHEN  VC.FUlL_CODE LIKE ''%''||CD.CUATM||'';%'' AND D.CAPITOL IN (404)  AND D.RIND IN (''07'') AND D.COL1 = 1  THEN 1 ELSE NULL END )  AS COL404'||CHR(13)||CHR(10)||' '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||' FROM'||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     USER_BANCU.VW_DATA_ALL D'||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'      INNER JOIN USER_BANCU.VW_CL_CUATM VC ON (VC.CODUL=D.CUATM)'||CHR(13)||CHR(10)||'      CROSS JOIN  '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'    '||CHR(13)||CHR(10)||'     '||CHR(13)||CHR(10)||'('||CHR(13)||CHR(10)||'   SELECT '||CHR(13)||CHR(10)||'         DENUMIRE           NUME_ROW,'||CHR(13)||CHR(10)||'         RIND               NR_ROW,'||CHR(13)||CHR(10)||'         RINDOUT           CUATM'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        FROM USER_BANCU.MD_RIND_OUT'||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        WHERE '||CHR(13)||CHR(10)||'        '||CHR(13)||CHR(10)||'        ID_MDTABLE = 8096'||CHR(13)||CHR(10)||'   )'||CHR(13)||CHR(10)||'   CD'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'WHERE '||CHR(13)||CHR(10)||'  (D.PERIOADA =:pPERIOADA) AND '||CHR(13)||CHR(10)||'  (D.FORM =:pFORM) AND'||CHR(13)||CHR(10)||'  (D.FORM_VERS =:pFORM_VERS) AND '||CHR(13)||CHR(10)||'  (:pID_MDTABLE =:pID_MDTABLE) AND'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  (D.CUATM_FULL LIKE ''%''||:pCOD_CUATM||'';%'') AND'||CHR(13)||CHR(10)||'   D.FORM IN (46) AND D.CAPITOL IN (1,404)'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'  GROUP BY '||CHR(13)||CHR(10)||'    CD.NR_ROW,'||CHR(13)||CHR(10)||'    CD.NUME_ROW'||CHR(13)||CHR(10)||'      '||CHR(13)||CHR(10)||'    ORDER BY '||CHR(13)||CHR(10)||'    CD.NR_ROW'||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||' ) AA '||CHR(13)||CHR(10)||'  '||CHR(13)||CHR(10)||'   ORDER BY AA.ORDINE' as SQL_TEXT,
  '' as SQL_TEXT1,
  '1' as LANDSCAPE,
  13 as COL_NUM,
  NULL as FOOTNOTE,
  NULL as UM,
  NULL as CREATING
  FROM DUAL) B
ON (A.ID_MDTABLE = B.ID_MDTABLE)
WHEN NOT MATCHED THEN 
INSERT (
  ID_MDTABLE, TABELE, TABELE_VERS, FORM, FORM_VERS, 
  DEN_SHORT, NIVELRAIONAL, ORDINE, STATUT, SQL_TEXT, 
  SQL_TEXT1, LANDSCAPE, COL_NUM, FOOTNOTE, UM, 
  CREATING)
VALUES (
  B.ID_MDTABLE, B.TABELE, B.TABELE_VERS, B.FORM, B.FORM_VERS, 
  B.DEN_SHORT, B.NIVELRAIONAL, B.ORDINE, B.STATUT, B.SQL_TEXT, 
  B.SQL_TEXT1, B.LANDSCAPE, B.COL_NUM, B.FOOTNOTE, B.UM, 
  B.CREATING)
WHEN MATCHED THEN
UPDATE SET 
  A.TABELE = B.TABELE,
  A.TABELE_VERS = B.TABELE_VERS,
  A.FORM = B.FORM,
  A.FORM_VERS = B.FORM_VERS,
  A.DEN_SHORT = B.DEN_SHORT,
  A.NIVELRAIONAL = B.NIVELRAIONAL,
  A.ORDINE = B.ORDINE,
  A.STATUT = B.STATUT,
  A.SQL_TEXT = B.SQL_TEXT,
  A.SQL_TEXT1 = B.SQL_TEXT1,
  A.LANDSCAPE = B.LANDSCAPE,
  A.COL_NUM = B.COL_NUM,
  A.FOOTNOTE = B.FOOTNOTE,
  A.UM = B.UM,
  A.CREATING = B.CREATING;

COMMIT;
