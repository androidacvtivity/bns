SELECT  
D.RIND,
 
SUM(CASE WHEN D.CAPITOL IN ('1117') AND RIND IN ('2310','2320','2400','4230','4240','5120') THEN NVAL(D.COL5)  ELSE 0 END) AS COL2

FROM
  CIS2.VW_DATA_ALL_GC D 
        
WHERE
  (D.PERIOADA=:PERIOADA         OR :PERIOADA = -1) AND
  (D.NR_GOSP=:NR_GOSP               OR :NR_GOSP = -1) AND
  (D.UNIT_CODE_VERS=:UNIT_CODE_VERS    OR :UNIT_CODE_VERS = -1) AND
  (D.FORM = :FORM               OR :FORM = -1) AND
  (D.FORM_VERS=:FORM_VERS       OR :FORM_VERS = -1) AND
  (:CAPITOL=:CAPITOL            OR :CAPITOL <> :CAPITOL) AND
  (:CAPITOL_VERS=:CAPITOL_VERS  OR :CAPITOL_VERS <> :CAPITOL_VERS) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
--  
  D.FORM IN (62)     
 
  GROUP BY 
  D.RIND
HAVING
  
   SUM(CASE WHEN D.CAPITOL IN ('1116') AND D.RIND IN '6215'  THEN NVAL(D.COL1) ELSE 0   END) = 0
   AND 
   SUM(CASE WHEN D.CAPITOL IN ('1117') AND RIND IN ('2310','2320','2400','4230','4240','5120') THEN NVAL(D.COL5)  ELSE 0 END) > 0 
    
  OR 
  
   SUM(CASE WHEN D.CAPITOL IN ('1116') AND D.RIND IN '6215'  THEN NVAL(D.COL1) ELSE 0   END) > 0
   AND 
   SUM(CASE WHEN D.CAPITOL IN ('1117') AND RIND IN ('2310','2320','2400','4230','4240','5120') THEN NVAL(D.COL5)  ELSE 0 END) = 0 