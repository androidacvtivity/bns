SELECT
1 ORDINE,
'010' RIND,
COUNT (DISTINCT CASE WHEN D.PERIOADA = 1040 AND D.RIND IN ('010') AND NVAL(D.COL1) <> 0  THEN D.UNIT_CODE ELSE NULL END ) AS COL1,

           
     
FROM
  VW_DATA_ALL_GC  D
WHERE
  (D.PERIOADA IN  (1048,1049,1047,1050,1051,1046,1045,1044,1043,1042,1041,1040))  AND   
  (D.FORM =:pFORM) AND
  
  D.FORM IN (58)  AND
  D.CAPITOL IN (416)