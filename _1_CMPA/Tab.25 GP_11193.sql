INSERT INTO CIS2.TABLE_OUT 
(
  PERIOADA,
  FORM,
  FORM_VERS,
  ID_MDTABLE,
  COD_CUATM,
  NR_SECTIE,
  NUME_SECTIE,
  NR_SECTIE1,
  NUME_SECTIE1,
  NR_SECTIE2,
  NUME_SECTIE2,
  NR_ROW,
  ORDINE,
  DECIMAL_POS,
  NUME_ROW,  
  COL1, COL2, COL3, COL4, COL5, COL6, COL7, COL8, COL9, COL10, COL11, COL12, COL13, COL14,COL15,COL16
)


SELECT
    :PPERIOADA AS PERIOADA,
    :PFORM AS FORM,
    :PFORM_VERS AS FORM_VERS,
    :PID_MDTABLE AS ID_MDTABLE,
    :PCOD_CUATM AS COD_CUATM,
    '0' AS NR_SECTIE,
    '0' AS NUME_SECTIE,
    '0' AS NR_SECTIE1,
    '0' AS NUME_SECTIE1,
    '0' AS NR_SECTIE2,
    '0' AS NUME_SECTIE2,
     RIND AS  NR_ROW,   
     ORDINE,
    '0000000000000000' AS DECIMAL_POS,
    DENUMIRE AS NUME_ROW, 
    ROUND(COL1,0) COL1,  
    ROUND(COL2,0) COL2,  
    ROUND(COL3,0) COL3,  
    ROUND (COL3/NOZERO(COL2),5) AS COL4, 
    ROUND(COL5,0) AS COL5,  
    ROUND(COL6,0) AS COL6,  
    ROUND(COL7,0) AS COL7,  
    ROUND (COL7/NOZERO(COL6),5) AS COL8,
    ROUND(COL9,0) AS COL9,  
    ROUND(COL10,0) AS COL10, 
    ROUND(COL11,0) AS COL11, 
    ROUND (COL11/NOZERO(COL10),5) AS COL12,
    ROUND(COL13,0) AS COL13, 
    ROUND(COL14,0) AS COL14,  
    ROUND(COL15,0) AS COL15, 
    ROUND (COL15/NOZERO(COL14),5) AS COL16
FROM
(

SELECT 
         1 AS ORDINE, 
         '250' AS RIND,
         'Total sămînțoase' AS DENUMIRE, 
         
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||1111111||';%' THEN D.COL1 ELSE NULL END)) / 3  AS COL1,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||1111111||';%' THEN D.COL2 ELSE NULL END)) / 3 AS COL2,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||1111111||';%' THEN D.COL3 ELSE NULL END)) AS COL3, 
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||1111111||';%' THEN D.COL3 ELSE NULL END)) /
         NOZERO (CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||1111111||';%' THEN D.COL2 ELSE NULL END)) / 3 ) AS COL4,
            
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||2222222||';%' THEN D.COL1 ELSE NULL END)) / 3 AS COL5,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||2222222||';%' THEN D.COL2 ELSE NULL END)) / 3 AS COL6,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||2222222||';%' THEN D.COL3 ELSE NULL END)) AS COL7, 
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||2222222||';%' THEN D.COL3 ELSE NULL END))/
         NOZERO (CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||2222222||';%' THEN D.COL2 ELSE NULL END)) / 3 ) AS COL8,
         
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND  ((D.CUATM_FULL LIKE '%'||3333333||';%') OR (D.CUATM_FULL LIKE '%'||9600000||';%')) THEN D.COL1 ELSE NULL END)) / 3  AS COL9,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND  ((D.CUATM_FULL LIKE '%'||3333333||';%') OR (D.CUATM_FULL LIKE '%'||9600000||';%')) THEN D.COL2 ELSE NULL END)) / 3  AS COL10,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND  ((D.CUATM_FULL LIKE '%'||3333333||';%') OR (D.CUATM_FULL LIKE '%'||9600000||';%')) THEN D.COL3 ELSE NULL END)) AS COL11, 
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND  ((D.CUATM_FULL LIKE '%'||3333333||';%') OR (D.CUATM_FULL LIKE '%'||9600000||';%')) THEN D.COL3 ELSE NULL END)) /
         NOZERO (CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND  ((D.CUATM_FULL LIKE '%'||3333333||';%') OR (D.CUATM_FULL LIKE '%'||9600000||';%')) THEN D.COL2 ELSE NULL END)) / 3) AS COL12,
         
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%' THEN D.COL1 ELSE NULL END)) / 3 AS COL13,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%' THEN D.COL2 ELSE NULL END)) / 3 AS COL14,
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%' THEN D.COL3 ELSE NULL END)) AS COL15, 
         CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%' THEN D.COL3 ELSE NULL END))/
         NOZERO (CIS2.NVAL(SUM(CASE WHEN D.CAPITOL IN ('1113') AND D.RIND IN ('210','220','230','240')  AND D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%' THEN D.COL2 ELSE NULL END)) / 3) AS COL16

   FROM
  
  CIS2.VW_DATA_ALL_GC   D                   
    
WHERE
--  (D.PERIOADA = :PPERIOADA)  AND
  (D.PERIOADA BETWEEN FLOOR(:pPERIOADA/4)*4 AND :pPERIOADA)  AND    
  (D.FORM =:PFORM) AND
  (D.FORM_VERS =:PFORM_VERS) AND 
  (:PID_MDTABLE =:PID_MDTABLE) AND
 (D.CUATM_FULL LIKE '%'||:PCOD_CUATM||';%') AND
  D.FORM IN (61) AND D.CAPITOL IN ('1113') -- AND NR_GOSP=285600
 )
  
 