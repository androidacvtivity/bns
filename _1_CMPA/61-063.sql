SELECT

' CAP 3 RIND - '|| L.RIND ||' - COL4 - '|| L.COL4 || 

' - CAP 2 RIND - '|| R.RIND ||' - COL2 - '|| R.COL2  
AS REZULTAT

FROM 


(
SELECT 
D.NR_GOSP, 
D.RIND,
SUM(D.COL4) AS COL4 


FROM
  CIS2.VW_DATA_ALL_GC D  
        
WHERE
  (D.PERIOADA IN  (:PERIOADA)         OR :PERIOADA = -1) AND
  (D.NR_GOSP=:NR_GOSP               OR :NR_GOSP = -1) AND
  (D.UNIT_CODE_VERS=:UNIT_CODE_VERS    OR :UNIT_CODE_VERS = -1) AND
  (D.FORM = :FORM               OR :FORM = -1) AND
  (D.FORM_VERS=:FORM_VERS       OR :FORM_VERS = -1) AND
  (:CAPITOL=:CAPITOL            OR :CAPITOL <> :CAPITOL) AND
  (:CAPITOL_VERS=:CAPITOL_VERS OR  :CAPITOL_VERS <>  :CAPITOL_VERS ) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
 
  D.FORM IN (61)  AND
  D.CAPITOL IN (1112)  
  AND D.RIND IN ('010','011','012','013','014','015',
  '016','017','020','021','022','023','024','030','040','041','042','043','044','045',
'046','047','048','049','050','051','052','053','054',
'060','070','071','072','080','081','082','083') 


GROUP BY 
D.NR_GOSP, 
D.RIND


 
  ) L LEFT JOIN   ( 
  
  SELECT 
D.NR_GOSP, 
D.RIND,
SUM(D.COL2) AS COL2 


FROM
  CIS2.VW_DATA_ALL_GC D  
        
WHERE
  (D.PERIOADA IN  (:PERIOADA-1)         OR :PERIOADA = -1) AND
  (D.NR_GOSP=:NR_GOSP               OR :NR_GOSP = -1) AND
  (D.UNIT_CODE_VERS=:UNIT_CODE_VERS    OR :UNIT_CODE_VERS = -1) AND
  (D.FORM = :FORM               OR :FORM = -1) AND
  (D.FORM_VERS=:FORM_VERS       OR :FORM_VERS = -1) AND
  (:CAPITOL=:CAPITOL            OR :CAPITOL <> :CAPITOL) AND
  (:CAPITOL_VERS=:CAPITOL_VERS OR  :CAPITOL_VERS <>  :CAPITOL_VERS ) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
 
  D.FORM IN (61)  AND
  D.CAPITOL IN (1111)  
  AND D.RIND IN ('010','011','012','013','014','015',
  '016','017','020','021','022','023','024','030','040','041','042','043','044','045',
'046','047','048','049','050','051','052','053','054',
'060','070','071','072','080','081','082','083') 


GROUP BY 
D.NR_GOSP, 
D.RIND

) R ON  R.NR_GOSP = L.NR_GOSP AND R.RIND = L.RIND


GROUP BY
L.RIND,
R.RIND,
L.COL4,
R.COL2


HAVING 

R.RIND IS NULL

AND 

(L.COL4 IS NOT NULL OR L.COL4 <> 0)   