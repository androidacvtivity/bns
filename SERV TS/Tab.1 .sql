SELECT
  B.RIND,  
  B.ORDINE,
  B.NUME_ROW,
  ROUND(SUM(CASE WHEN B.NR_ROW LIKE '%'||SUBSTR(C.CODUL,2,5)||'%' AND D.PERIOADA BETWEEN FLOOR(:pPERIOADA/12)*12 AND (:pPERIOADA) THEN D.COL1 ELSE NULL  END),1) AS COL1
   
 

FROM 
  CIS.VW_DATA_ALL_COEF D
  INNER JOIN CIS.VW_CL_CAEM2 C ON C.CODUL = D.CAEM2
  CROSS JOIN
    ( SELECT '5500+5510+5520+5530+5590+5600+5610+5620+5621+5629
             +5630+7420+7500+7720+7721+7722+7729+7900+7910+7911
             +7912+7990+8500+8510+8520+8530+8531+8532+8540+8541
             +8542+8550+8551+8552+8553+8559+8560+8600+8610+8620
             +8621+8622+8623+8690+8700+8710+8720+8730+8790+8800
             +8810+8890+8891+8899+5900+5910+5911+5912+5913+5914
             +5920+6000+6010+6020+9000+9001+9002+9003+9004+9100
             +9101+9102+9103+9104+9200+9300+9310+9311+9312+9313
             +9319+9320+9321+9329+9500+9510+9511+9512+9520+9521
             +9522+9523+9524+9525+9529+9601+9602+9603+9604+0160
             +0161+0162+0163+0164+7430+9609' AS NR_ROW,0 AS ORDINE, '01' AS RIND, 'Cifra de afeceri (venitul din vinzari) - total:' AS NUME_ROW FROM DUAL
     

    ) B
    
WHERE
 (D.FORM=:pFORM) AND
 (D.FORM_VERS=:pFORM_VERS) AND
 (:pID_MDTABLE=:pID_MDTABLE) AND
 (D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%') AND   
  (  
     (D.PERIOADA BETWEEN FLOOR(:pPERIOADA/12)*12 AND :pPERIOADA) 
     
     
     
     
      
         ) AND
  D.FORM IN (4) AND 
  D.CAPITOL IN (4) AND
  D.RIND IN '10'
  
GROUP BY
  B.NUME_ROW,
  B.RIND,
  B.ORDINE

